
- name: Configure replication peers (array connections)
  purestorage.flasharray.purefa_array:
    fa_url: "{{ fa_url }}"
    api_token: "{{ api_token }}"
    remote_array: "{{ item.name }}"
    remote_url: "{{ item.url }}"
    remote_api_token: "{{ item.api_token }}"
    transport: "{{ item.type | default(omit) }}"
    state: present
  loop: "{{ peers | default([]) }}"
  loop_control: { label: "{{ item.name }}" }
