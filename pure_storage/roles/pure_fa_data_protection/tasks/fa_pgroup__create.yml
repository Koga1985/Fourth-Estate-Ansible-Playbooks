
- name: Create/update protection groups and add volumes
  purestorage.flasharray.purefa_pg:
    fa_url: "{{ fa_url }}"
    api_token: "{{ api_token }}"
    pgroup: "{{ item.name }}"
    volumes: "{{ item.volumes | default([]) }}"
    state: present
  loop: "{{ pgroups | default([]) }}"
  loop_control: { label: "{{ item.name }}" }
