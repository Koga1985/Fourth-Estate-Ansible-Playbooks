---
# Pure Storage FlashArray Protection Handlers

- name: refresh snapshot catalog
  purefa_info:
    fa_url: "{{ flasharray_url }}"
    api_token: "{{ flasharray_api_token }}"
    gather_subset:
      - snapshots
  register: snapshot_refresh

- name: verify protection groups
  purefa_info:
    fa_url: "{{ flasharray_url }}"
    api_token: "{{ flasharray_api_token }}"
    gather_subset:
      - pgroups
  register: pgroup_verify

- name: notify backup system
  ansible.builtin.debug:
    msg: "Snapshot created - notify backup/replication systems"

- name: update snapshot documentation
  ansible.builtin.debug:
    msg: "Protection configuration updated - update documentation"

- name: test snapshot restore
  ansible.builtin.debug:
    msg: "Snapshot schedules configured - schedule restore test"

- name: verify safemode snapshots
  ansible.builtin.debug:
    msg: "SafeMode snapshots configured - verify immutability"
