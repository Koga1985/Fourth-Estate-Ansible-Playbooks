
- name: Create/resize volumes with QoS and tags
  purestorage.flasharray.purefa_volume:
    fa_url: "{{ fa_url }}"
    api_token: "{{ api_token }}"
    name: "{{ item.name }}"
    size: "{{ item.size }}"
    qos_iops_limit: "{{ item.qos_iops_limit | default(omit) }}"
    qos_bandwidth_limit: "{{ item.qos_bandwidth_limit | default(omit) }}"
    labels: "{{ item.tags | default(omit) }}"
    state: present
  loop: "{{ volumes }}"
  loop_control: { label: "{{ item.name }}" }
