---
# vars:
# hostgroups:
#  - { name: esx-cluster-a, hosts: [ "esx-01", "esx-02" ] }
- name: Create or update host groups
  purestorage.flasharray.purefa_hgroup:
    fa_url: "{{ fa_url }}"
    api_token: "{{ api_token }}"
    hgroup: "{{ item.name }}"
    hosts: "{{ item.hosts | default([]) }}"
    state: present
  loop: "{{ hostgroups | default([]) }}"
  loop_control: { label: "{{ item.name }}" }
