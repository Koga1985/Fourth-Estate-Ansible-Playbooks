---
- name: Ensure artifacts dir
  ansible.builtin.file:
    path: "{{ artifacts_dir | default('/tmp/ot-artifacts') }}"
    state: directory
    mode: "0755"

- name: Version/health inventory
  ansible.builtin.copy:
    dest: "{{ artifacts_dir }}/sensors_inventory.csv"
    mode: "0644"
    content: |
      name,site,version,status,last_seen
      {% for s in sensors | default([]) %}
      {{ s.name | default('') }},{{ s.site | default('') }},{{ s.version | default('') }},{{ s.status | default('unknown') }},{{ s.last_seen | default('') }}
      {% endfor %}
