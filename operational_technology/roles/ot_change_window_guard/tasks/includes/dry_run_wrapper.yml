---
- name: Ensure artifacts dir
  ansible.builtin.file:
    path: "{{ artifacts_dir | default('/tmp/ot-artifacts') }}"
    state: directory
    mode: "0755"

- name: Force dry-run when not explicitly allowed
  ansible.builtin.set_fact:
    effective_dry_run: "{{ (dry_run | default(true)) or not (_allowed | default(false) | bool) }}"
- name: Emit guard status
  ansible.builtin.debug:
    msg:
      window_allowed: "{{ _allowed | default(false) }}"
      effective_dry_run: "{{ effective_dry_run }}"
