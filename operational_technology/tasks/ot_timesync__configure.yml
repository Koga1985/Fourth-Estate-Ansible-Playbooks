---
# Guarded write (maintenance window + non-dry-run).
- name: Ensure artifacts dir
  ansible.builtin.file:
    path: "{{ artifacts_dir | default('/tmp/ot-artifacts') }}"
    state: directory
    mode: "0755"

- name: Guard write operations
  ansible.builtin.assert:
    that:
      - maintenance_window | default(false) | bool
      - not (dry_run | default(true) | bool)
    fail_msg: "Blocked: enable maintenance_window=true and dry_run=false to push time config."

- name: Apply time configuration (placeholder)
  ansible.builtin.debug:
    msg: "Would write NTP/PTP config with servers={ timesources | default([]) }"
