---
# Claroty xDome Secure Remote Access - Session Policy Configuration
# Fourth Estate OT/ICS Security Configuration

artifacts_dir: "/tmp/claroty-artifacts"
log_dir: "/var/log/claroty"

# Claroty xDome API Configuration
claroty:
  base_url: "https://xdome.claroty.com/api"
  token: "{{ lookup('env', 'CLAROTY_API_TOKEN') }}"
  verify_ssl: true
  timeout: 30

# Session Policies
session_policies: []
# Example session policy:
# - name: "vendor-restricted-sessions"
#   description: "Restrictive session policy for vendor remote access"
#   enabled: true
#   priority: 10
#   applies_to:
#     user_types: ["vendor", "contractor"]
#     groups: ["vendor-acme", "ot-access"]
#   session_timeout:
#     enabled: true
#     timeout_minutes: 240
#     warning_minutes: 15
#     allow_extension: true
#     max_extensions: 2
#     extension_duration_minutes: 60
#   idle_timeout:
#     enabled: true
#     timeout_minutes: 15
#     warning_minutes: 5
#   session_recording:
#     enabled: true
#     recording_type: "full"          # full, keystrokes, commands
#     store_locally: false
#     retention_days: 365
#     encryption: true
#     watermark: true
#     quality: "high"                 # high, medium, low
#   file_transfer:
#     policy: "deny"                  # allow, deny, approval_required
#     allowed_directions: []          # upload, download
#     max_file_size_mb: 100
#     allowed_file_types: []
#     scan_for_malware: true
#     quarantine_suspicious: true
#   clipboard:
#     policy: "deny"                  # allow, deny, one_way_in, one_way_out
#     max_clipboard_size_kb: 100
#   printing:
#     policy: "deny"                  # allow, deny
#     watermark_enabled: true
#   screenshot_capture:
#     policy: "deny"                  # allow, deny
#   screen_sharing:
#     policy: "deny"                  # allow, deny
#   watermark:
#     enabled: true
#     text: "CONTROLLED - {{ user_email }} - {{ timestamp }}"
#     position: "diagonal"            # top, bottom, diagonal
#     opacity: 0.3
#     include_session_id: true
#     include_timestamp: true
#   concurrent_sessions:
#     max_sessions: 1
#     per_user: true
#     per_protocol: false
#   time_based_access:
#     enabled: true
#     windows:
#       - days: ["monday", "tuesday", "wednesday", "thursday", "friday"]
#         start_time: "08:00"
#         end_time: "17:00"
#         timezone: "America/New_York"
#     blackout_periods:
#       - start: "2026-12-24T00:00:00Z"
#         end: "2026-12-26T23:59:59Z"
#         reason: "Holiday freeze"
#   ip_restrictions:
#     enabled: true
#     allowlist:
#       - "203.0.113.0/24"
#       - "198.51.100.0/24"
#     blocklist: []
#     check_reverse_dns: true
#   protocol_settings:
#     rdp:
#       enabled: true
#       clipboard: "deny"
#       file_transfer: "deny"
#       printer_redirection: false
#       audio_redirection: false
#       drive_redirection: false
#       port_redirection: false
#       smartcard_redirection: false
#       usb_redirection: false
#       clipboard_text_only: false
#       max_resolution: "1920x1080"
#       color_depth: 24
#     ssh:
#       enabled: true
#       sftp: "deny"
#       port_forwarding: false
#       x11_forwarding: false
#       agent_forwarding: false
#       tcp_forwarding: false
#       command_recording: true
#       allowed_commands: []
#       blocked_commands: ["rm -rf", "dd", "mkfs"]
#     vnc:
#       enabled: true
#       clipboard: "deny"
#       view_only: false
#       max_resolution: "1920x1080"
#     https:
#       enabled: true
#       ssl_inspection: false
#   security_controls:
#     require_mfa: true
#     mfa_frequency: "per_session"    # per_session, per_connection, daily
#     certificate_pinning: false
#     require_trusted_devices: false
#     geo_fencing:
#       enabled: false
#       allowed_countries: ["US"]
#     anomaly_detection:
#       enabled: true
#       sensitivity: "medium"          # low, medium, high
#     session_termination_on_policy_violation: true

# Default Session Policy (fallback)
default_session_policy:
  enabled: true
  session_timeout_minutes: 480
  idle_timeout_minutes: 30
  session_recording: true
  file_transfer: "deny"
  clipboard: "deny"
  printing: "deny"
  screenshot_capture: "deny"
  concurrent_sessions_max: 2
  require_mfa: true

# Session Policy Templates (pre-configured)
policy_templates:
  high_security:
    enabled: true
    session_timeout_minutes: 120
    idle_timeout_minutes: 10
    session_recording: true
    recording_type: "full"
    file_transfer: "deny"
    clipboard: "deny"
    printing: "deny"
    watermark_enabled: true
    concurrent_sessions_max: 1
    require_mfa: true

  standard_vendor:
    enabled: true
    session_timeout_minutes: 240
    idle_timeout_minutes: 15
    session_recording: true
    recording_type: "full"
    file_transfer: "approval_required"
    clipboard: "deny"
    printing: "deny"
    watermark_enabled: true
    concurrent_sessions_max: 1
    require_mfa: true

  operator_access:
    enabled: true
    session_timeout_minutes: 480
    idle_timeout_minutes: 30
    session_recording: true
    recording_type: "keystrokes"
    file_transfer: "allow"
    clipboard: "one_way_in"
    printing: "allow"
    watermark_enabled: true
    concurrent_sessions_max: 3
    require_mfa: true

# Monitoring and Alerts
monitoring:
  enabled: true
  alert_on_policy_violation: true
  alert_on_session_timeout: false
  alert_on_idle_timeout: false
  alert_on_failed_mfa: true
  alert_on_suspicious_activity: true
  alert_recipients:
    - "ot-security@agency.gov"

# Compliance Settings
compliance:
  log_policy_changes: true
  log_policy_applications: true
  log_policy_violations: true
  require_justification_for_policy_changes: true
  periodic_policy_review_days: 90

# Reporting
reporting:
  enabled: true
  session_policy_compliance_report: true
  policy_violation_report: true
  session_usage_report: true
  report_schedule: "weekly"
  report_recipients:
    - "ot-management@agency.gov"
