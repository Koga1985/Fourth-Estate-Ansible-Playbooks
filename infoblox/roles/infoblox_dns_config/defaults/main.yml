---
# defaults file for infoblox_dns_config
# Infoblox DNS Service Configuration defaults for Fourth Estate

# Grid connection settings (inherited from grid_config)
infoblox_grid_master: "infoblox-master.example.com"
infoblox_username: "admin"
infoblox_password: "{{ vault_infoblox_password }}"
infoblox_wapi_version: "2.12"
infoblox_validate_certs: true

# DNS Views for Split DNS (Fourth Estate: internal/external)
infoblox_dns_views:
  - name: "internal"
    network_view: "default"
    comment: "Internal DNS view for Fourth Estate staff and systems"
    enable_blacklist: false
    enable_fixed_rrset_order: false
    state: present
  - name: "external"
    network_view: "default"
    comment: "External DNS view for public-facing services"
    enable_blacklist: false
    state: present
  - name: "source-protection"
    network_view: "default"
    comment: "Isolated DNS view for source protection network"
    enable_blacklist: true
    state: present

# DNS Forwarders
infoblox_forwarder_group_name: "fourth-estate-forwarders"
infoblox_dns_forwarders:
  - name: "Cloudflare-Primary"
    address: "1.1.1.1"
  - name: "Cloudflare-Secondary"
    address: "1.0.0.1"
  - name: "Google-Primary"
    address: "8.8.8.8"
  - name: "Google-Secondary"
    address: "8.8.4.4"

# Root Hints (use default IANA root servers unless airgapped)
infoblox_configure_root_hints: false
infoblox_root_hints: []

# DNSSEC Configuration
infoblox_enable_dnssec: true
infoblox_enable_dnssec_validation: true
infoblox_dnssec_validation_policy: "strict"
infoblox_dnssec_key_algorithm: "RSASHA256"
infoblox_dnssec_ksk_size: 2048
infoblox_dnssec_zsk_size: 1024
infoblox_dnssec_ksk_rollover: "AUTO"
infoblox_dnssec_zsk_rollover: "AUTO"

# Response Rate Limiting (RRL) for DDoS protection
infoblox_enable_rrl: true
infoblox_rrl_ipv4_prefix: 24
infoblox_rrl_ipv6_prefix: 56
infoblox_rrl_responses_per_second: 5
infoblox_rrl_errors_per_second: 5
infoblox_rrl_nxdomains_per_second: 5
infoblox_rrl_slip_ratio: 2
infoblox_rrl_window: 15

# Recursive Queries Configuration
infoblox_allow_recursive_queries: true
infoblox_recursive_query_acl:
  - "10.0.0.0/8"      # Internal networks
  - "172.16.0.0/12"   # Internal networks
  - "192.168.0.0/16"  # Internal networks

# DNS Query Source
infoblox_dns_query_source: ""  # Leave empty for automatic
infoblox_dns_query_source_v6: ""

# DNS Cache Settings
infoblox_max_cache_ttl: 86400       # 1 day
infoblox_max_ncache_ttl: 10800      # 3 hours
infoblox_max_cached_lifetime: 604800  # 7 days
infoblox_lame_ttl: 600              # 10 minutes

# DNS Logging for Security Analysis (365+ day retention via syslog)
infoblox_enable_query_logging: true
infoblox_log_queries: true
infoblox_log_rpz_actions: true
infoblox_enable_dns_stats: true

# DNS Query ACLs (zone-specific)
infoblox_dns_query_acls: []

# DNS Blackhole List (query source restrictions)
infoblox_dns_blackhole_list:
  - "0.0.0.0/8"
  - "169.254.0.0/16"
  - "224.0.0.0/4"

# DNS64 for IPv6 transition
infoblox_enable_dns64: false
infoblox_dns64_prefix: ""

# DNS Notification Settings
infoblox_notify_delay: 5
infoblox_also_notify: []

# DNS Sortlist (for geographic response ordering)
infoblox_dns_sortlist: []

# Fourth Estate specific DNS settings
# Split DNS configuration for internal vs external resolution
infoblox_split_dns_enabled: true

# DNS query logging for security analysis
infoblox_dns_security_logging: true

# Publication system DNS records management
infoblox_publication_dns_enabled: true

# Content delivery DNS management
infoblox_cdn_dns_enabled: true

# Threat intelligence integration
infoblox_threat_dns_enabled: true
