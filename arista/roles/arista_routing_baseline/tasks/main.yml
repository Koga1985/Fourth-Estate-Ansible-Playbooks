---
- name: Ensure artifacts dir
  ansible.builtin/file: { path: "{{ artifacts_dir }}", state: directory }
- name: Plan routing
  ansible.builtin/copy:
    dest: "{{ artifacts_dir }}/routing_plan.json"
    content: "{{ {'loopbacks': loopbacks, 'static_routes': static_routes} | to_nice_json }}"
    mode: "0644"
- name: Loopbacks
  when: apply_changes | bool
  arista.eos.eos_l3_interfaces:
    config: "{{ loopbacks }}"
    state: merged
- name: Static routes
  when: apply_changes | bool
  arista.eos.eos_static_routes:
    config: "{{ static_routes }}"
    state: merged
