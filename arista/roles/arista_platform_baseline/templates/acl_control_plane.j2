!
! Control Plane ACL for DISA STIG V-220545
! Restricts management access to authorized networks
!
ip access-list {{ arista_baseline.control_plane_acl | default('CONTROL_PLANE_ACL') }}
   10 remark ** Permit SSH from Management Networks **
   10 permit tcp {{ arista_mgmt_network | default('10.0.0.0/8') }} any eq ssh
   20 remark ** Permit HTTPS for eAPI from Management Networks **
   20 permit tcp {{ arista_mgmt_network | default('10.0.0.0/8') }} any eq 443
   30 remark ** Permit SNMP from Monitoring Systems **
   30 permit udp {{ arista_monitoring_network | default('10.0.0.0/24') }} any eq snmp
   40 remark ** Permit NTP from Time Sources **
   40 permit udp host {{ arista_ntp_server_1 | default('10.0.0.10') }} eq ntp any
   50 permit udp host {{ arista_ntp_server_2 | default('10.0.0.11') }} eq ntp any
   60 remark ** Permit Syslog to Remote Servers **
   60 permit tcp any host {{ arista_syslog_server_1 | default('10.0.0.30') }} eq 6514
   70 permit tcp any host {{ arista_syslog_server_2 | default('10.0.0.31') }} eq 6514
   80 remark ** Permit TACACS+ **
   80 permit tcp any host {{ arista_tacacs_server_1 | default('10.0.0.40') }} eq tacacs
   90 permit tcp any host {{ arista_tacacs_server_2 | default('10.0.0.41') }} eq tacacs
   100 remark ** Permit BGP from Peers **
   100 permit tcp {{ arista_bgp_peer_network | default('10.0.0.0/8') }} any eq bgp
   110 permit tcp {{ arista_bgp_peer_network | default('10.0.0.0/8') }} eq bgp any
   120 remark ** Permit OSPF **
   120 permit ospf any any
   130 remark ** Permit ICMP for troubleshooting **
   130 permit icmp any any echo
   140 permit icmp any any echo-reply
   150 permit icmp any any time-exceeded
   160 permit icmp any any unreachable
   9999 remark ** Deny and Log Everything Else **
   9999 deny ip any any log
!
