---
# defaults file for azure_rbac - Azure Role-Based Access Control
# Fourth Estate Azure Government Cloud Configuration

# Azure Cloud Environment
azure_cloud_environment: "AzureUSGovernment"
azure_region: "usgovvirginia"
azure_tenant_id: "{{ lookup('env', 'AZURE_TENANT_ID') }}"
azure_subscription_id: "{{ lookup('env', 'AZURE_SUBSCRIPTION_ID') }}"

# Resource Group
azure_resource_group: "rg-identity-prod-usgovva"

# Custom RBAC Roles
azure_rbac_custom_roles: []
# Example:
# azure_rbac_custom_roles:
#   - name: "4E-SecOps-Reader"
#     description: "Fourth Estate Security Operations Reader"
#     actions:
#       - "Microsoft.Security/*/read"
#       - "Microsoft.SecurityInsights/*/read"
#       - "Microsoft.OperationalInsights/workspaces/*/read"
#     not_actions: []
#     data_actions: []
#     assignable_scopes:
#       - "/subscriptions/{{ azure_subscription_id }}"

# User Role Assignments
azure_rbac_user_assignments: []
# Example:
# azure_rbac_user_assignments:
#   - assignee_object_id: "user-object-id-here"
#     role_name: "Security Reader"
#     scope: "/subscriptions/{{ azure_subscription_id }}"

# Group Role Assignments
azure_rbac_group_assignments: []
# Example:
# azure_rbac_group_assignments:
#   - group_object_id: "group-object-id-here"
#     role_name: "Contributor"
#     scope: "/subscriptions/{{ azure_subscription_id }}/resourceGroups/rg-prod"

# Service Principal Role Assignments
azure_rbac_sp_assignments: []
# Example:
# azure_rbac_sp_assignments:
#   - sp_object_id: "sp-object-id-here"
#     role_name: "Reader"
#     scope: "/subscriptions/{{ azure_subscription_id }}"

# Privileged Identity Management (PIM) Assignments
azure_rbac_pim_assignments: []
# Example:
# azure_rbac_pim_assignments:
#   - principal_id: "user-object-id"
#     role_definition_id: "/subscriptions/.../roleDefinitions/..."
#     justification: "Temporary elevated access for incident response"
#     duration: "PT8H"
#     expiration_type: "AfterDuration"

# Deny Assignments (Least Privilege)
azure_rbac_deny_assignments: []
# Example:
# azure_rbac_deny_assignments:
#   - name: "deny-delete-resources"
#     principal_id: "group-object-id"
#     denied_actions:
#       - "*/delete"
#     scope: "/subscriptions/{{ azure_subscription_id }}/resourceGroups/rg-prod"

# Privileged Identity Management
azure_rbac_enable_pim: true

# Audit and Compliance
azure_rbac_enable_audit_logging: true
azure_log_analytics_workspace_id: ""  # To be populated

# Reporting
azure_rbac_generate_report: true
azure_rbac_report_path: "/var/lib/ansible/rbac_compliance_report.json"

# Operational Settings
azure_rbac_display_summary: true

# Cost Management
azure_environment: "Production"
azure_cost_center: "4thEstate-Identity"
azure_classification: "SECRET"

# Resource Tags
azure_resource_tags:
  Environment: "{{ azure_environment }}"
  CostCenter: "{{ azure_cost_center }}"
  Classification: "{{ azure_classification }}"
  Compliance: "FedRAMP-High"
  ManagedBy: "Ansible"

# FedRAMP High Controls Mapping
# AC-2: Account Management
# AC-3: Access Enforcement
# AC-6: Least Privilege
# AU-2: Audit Events
# AU-11: Audit Record Retention
