---
# defaults file for azure_ad_mfa - Azure AD Multi-Factor Authentication
# Fourth Estate Azure Government Cloud Configuration

# Azure Cloud Environment
azure_cloud_environment: "AzureUSGovernment"
azure_region: "usgovvirginia"
azure_tenant_id: "{{ lookup('env', 'AZURE_TENANT_ID') }}"

# Resource Group
azure_resource_group: "rg-identity-prod-usgovva"

# MFA Service Configuration
azure_mfa_enable_service: true
azure_mfa_configure_registration: true
azure_mfa_security_defaults: true

# MFA Method Configurations
azure_mfa_method_configurations:
  - "@odata.type": "#microsoft.graph.microsoftAuthenticatorAuthenticationMethodConfiguration"
    state: enabled
  - "@odata.type": "#microsoft.graph.fido2AuthenticationMethodConfiguration"
    state: enabled
  - "@odata.type": "#microsoft.graph.smsAuthenticationMethodConfiguration"
    state: disabled

# Microsoft Authenticator Settings
azure_mfa_configure_authenticator: true
azure_mfa_display_app_info: "enabled"
azure_mfa_display_location: "enabled"
azure_mfa_number_matching: "enabled"  # Phishing-resistant

# FIDO2 Security Key Settings
azure_mfa_enable_fido2: true
azure_mfa_fido2_self_service: true
azure_mfa_fido2_attestation: true
azure_mfa_fido2_restriction_type: "allow"
azure_mfa_fido2_allowed_guids: []  # Specific FIDO2 keys allowed
azure_mfa_fido2_target_group: "all_users"

# SMS Authentication (Generally disabled for security)
azure_mfa_configure_sms: true
azure_mfa_sms_enabled: "disabled"
azure_mfa_sms_target_group: "none"

# Per-User MFA Settings
azure_mfa_per_user_settings: []
# Example:
# azure_mfa_per_user_settings:
#   - user_id: "user-object-id"
#     mfa_state: "enforced"  # Options: disabled, enabled, enforced

# Fraud Alert Settings
azure_mfa_enable_fraud_alert: true
azure_mfa_fraud_auto_block: true
azure_mfa_fraud_auto_report: true

# Remember Devices (Typically disabled for high security)
azure_mfa_configure_remember: false
azure_mfa_remember_devices: "disabled"
azure_mfa_remember_days: 0

# Audit and Compliance
azure_mfa_enable_diagnostics: true
azure_log_analytics_workspace_id: ""  # To be populated

# Operational Settings
azure_mfa_display_summary: true

# Cost Management
azure_environment: "Production"
azure_cost_center: "4thEstate-Identity"
azure_classification: "SECRET"

# Resource Tags
azure_resource_tags:
  Environment: "{{ azure_environment }}"
  CostCenter: "{{ azure_cost_center }}"
  Classification: "{{ azure_classification }}"
  Compliance: "FedRAMP-High"
  ManagedBy: "Ansible"

# FedRAMP High Controls Mapping
# IA-2: Identification and Authentication (Organizational Users)
# IA-2(1): Network Access to Privileged Accounts
# IA-2(2): Network Access to Non-Privileged Accounts
# IA-2(12): Acceptance of PIV Credentials
# IA-5: Authenticator Management
# IA-8: Identification and Authentication (Non-Organizational Users)
# AU-2: Audit Events
