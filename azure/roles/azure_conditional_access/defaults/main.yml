---
# defaults file for azure_conditional_access - Azure AD Conditional Access
# Fourth Estate Azure Government Cloud Configuration

# Azure Cloud Environment
azure_cloud_environment: "AzureUSGovernment"
azure_region: "usgovvirginia"
azure_tenant_id: "{{ lookup('env', 'AZURE_TENANT_ID') }}"

# Resource Group
azure_resource_group: "rg-identity-prod-usgovva"

# Conditional Access Policies
azure_conditional_access_policies: []
# Example:
# azure_conditional_access_policies:
#   - name: "ca-require-mfa-admins"
#     display_name: "Require MFA for Administrators"
#     state: "enabled"
#     include_applications: ["All"]
#     include_users: []
#     include_groups: ["admin-group-id"]
#     include_locations: ["All"]
#     exclude_locations: ["AllTrusted"]
#     include_platforms: ["all"]
#     client_app_types: ["all"]
#     signin_risk_levels: ["high", "medium"]
#     user_risk_levels: ["high"]
#     grant_operator: "AND"
#     grant_controls: ["mfa", "compliantDevice"]
#     signin_frequency_value: 1
#     signin_frequency_type: "hours"
#     persistent_browser_mode: "never"
#     cloud_app_security_enabled: true
#     cloud_app_security_type: "monitorOnly"

# Baseline Fourth Estate Policies
azure_ca_deploy_baseline_policies: true
azure_breakglass_group_id: ""  # Break-glass account group

# Named Locations
azure_ca_named_locations: []
# Example:
# azure_ca_named_locations:
#   - name: "4E-TrustedIPs"
#     display_name: "Fourth Estate Trusted IP Ranges"
#     is_trusted: true
#     ip_ranges:
#       - "192.168.1.0/24"
#       - "10.0.0.0/8"

# Authentication Strength Policies
azure_ca_auth_strength_policies: []
# Example:
# azure_ca_auth_strength_policies:
#   - name: "4E-PhishingResistant"
#     display_name: "Fourth Estate Phishing-Resistant MFA"
#     description: "Requires phishing-resistant authentication methods"
#     requirements_satisfied: ["mfa"]
#     allowed_combinations:
#       - "fido2"
#       - "windowsHelloForBusiness"
#       - "x509CertificateMultiFactor"

# Audit and Compliance
azure_ca_enable_diagnostics: true
azure_log_analytics_workspace_id: ""  # To be populated

# Operational Settings
azure_ca_display_summary: true

# Cost Management
azure_environment: "Production"
azure_cost_center: "4thEstate-Identity"
azure_classification: "SECRET"

# Resource Tags
azure_resource_tags:
  Environment: "{{ azure_environment }}"
  CostCenter: "{{ azure_cost_center }}"
  Classification: "{{ azure_classification }}"
  Compliance: "FedRAMP-High"
  ManagedBy: "Ansible"

# FedRAMP High Controls Mapping
# AC-2: Account Management
# AC-3: Access Enforcement
# AC-7: Unsuccessful Logon Attempts
# IA-2: Identification and Authentication
# IA-8: Identification and Authentication (Non-Organizational Users)
# AU-2: Audit Events
