---
# handlers file for aws_iam_groups

- name: notify iam group changes
  ansible.builtin.debug:
    msg: "IAM group configuration has been updated. Review group memberships and policies."

- name: trigger compliance scan
  ansible.builtin.uri:
    url: "{{ compliance_webhook_url }}"
    method: POST
    body_format: json
    body:
      event: "iam_group_change"
      timestamp: "{{ ansible_date_time.iso8601 }}"
      resource_type: "IAM Group"
    status_code: [200, 201, 204]
  when: compliance_webhook_url is defined
  delegate_to: localhost
