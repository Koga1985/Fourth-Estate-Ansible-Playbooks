---
# defaults file for aws_iam_access_analyzer

# Access Analyzer Configuration
iam_access_analyzer_name: "FedRAMP-Access-Analyzer"
iam_access_analyzer_type: "ACCOUNT"  # ACCOUNT, ORGANIZATION
iam_access_analyzer_state: "present"

# Tags
iam_access_analyzer_tags:
  ManagedBy: "Ansible"
  Environment: "{{ aws_environment | default('production') }}"
  Compliance: "FedRAMP-High"
  SecurityControl: "AccessAnalysis"
  CostCenter: "{{ cost_center | default('IT-Security') }}"

# Findings Configuration
iam_generate_findings_report: true
iam_access_analyzer_max_findings: 100
iam_access_analyzer_alert_threshold: 1

# High-risk resource types to monitor
iam_high_risk_resource_types:
  - "AWS::IAM::Role"
  - "AWS::S3::Bucket"
  - "AWS::KMS::Key"
  - "AWS::Lambda::Function"
  - "AWS::SQS::Queue"
  - "AWS::SNS::Topic"

# Archive rules (override in inventory/playbook)
iam_access_analyzer_archive_rules: []
#  - name: "ArchiveInternalAccess"
#    filter:
#      principal:
#        aws:
#          - "arn:aws-us-gov:iam::123456789012:root"
#    state: present

# CloudWatch Integration
iam_create_cloudwatch_alarms: true
iam_access_analyzer_sns_topic: ""

# Organization-wide analyzer
iam_enable_organization_analyzer: false

# Webhook for security notifications
security_webhook_url: ""
