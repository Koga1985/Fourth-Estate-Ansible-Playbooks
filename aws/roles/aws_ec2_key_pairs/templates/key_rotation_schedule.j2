EC2 Key Pair Rotation Schedule
===============================
Generated: {{ ansible_date_time.iso8601 }}
Rotation Period: {{ key_pair_rotation_days }} days

{% if ec2_key_pairs is defined %}
Key Pairs Requiring Rotation:
{% for key in ec2_key_pairs %}
  - Name: {{ key.name }}
    Region: {{ key.region | default(aws_region) }}
    Next Rotation: {{ (ansible_date_time.epoch | int + (key_pair_rotation_days * 86400)) | int | to_datetime('%Y-%m-%d') }}
    Purpose: {{ key.tags.Purpose | default('Not specified') }}
{% endfor %}
{% endif %}

Best Practices:
  1. Rotate keys every {{ key_pair_rotation_days }} days
  2. Store private keys in encrypted storage (KMS, Vault, etc.)
  3. Never commit private keys to version control
  4. Use different keys for different environments
  5. Implement break-glass procedures for emergency access
  6. Audit key usage regularly through CloudTrail

Compliance: FedRAMP High requires regular key rotation and secure key management.
