VPN Configuration Report
========================
Generated: {{ ansible_date_time.iso8601 }}

{% if vpn_gateway_result is defined and vpn_gateway_result.vgw is defined %}
Virtual Private Gateway:
  ID: {{ vpn_gateway_result.vgw.id }}
  Name: {{ vpn_gateway_name }}
  Type: {{ vpn_gateway_type }}
  ASN: {{ vpn_gateway_asn }}
  State: {{ vpn_gateway_result.vgw.state }}
{% endif %}

{% if customer_gateway_result is defined %}
Customer Gateways:
{% for cgw in customer_gateway_result.results %}
  - Name: {{ cgw.item.name }}
    ID: {{ cgw.gateway.customer_gateway_id if cgw.gateway is defined else 'N/A' }}
    IP: {{ cgw.item.ip_address }}
    BGP ASN: {{ cgw.item.bgp_asn }}
{% endfor %}
{% endif %}

{% if vpn_connection_result is defined %}
VPN Connections:
{% for vpn in vpn_connection_result.results %}
  - Name: {{ vpn.item.name }}
    ID: {{ vpn.vpn_connection.vpn_connection_id if vpn.vpn_connection is defined else 'N/A' }}
    State: {{ vpn.vpn_connection.state if vpn.vpn_connection is defined else 'N/A' }}
    Type: {{ vpn.vpn_connection.type if vpn.vpn_connection is defined else 'N/A' }}
    Static Routes: {{ vpn.item.routes | join(', ') if vpn.item.routes is defined else 'Dynamic BGP' }}
{% endfor %}
{% endif %}

Security Configuration:
  Encryption: AES256
  Integrity: SHA2-256
  IKE Version: IKEv2
  DH Groups: 14-24
  Compliance: FedRAMP High

IMPORTANT: Store this configuration securely. Contains sensitive network information.
