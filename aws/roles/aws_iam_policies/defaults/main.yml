---
# defaults file for aws_iam_policies

# IAM Policy Configuration
iam_policy_state: "present"

# Default tags for all IAM policies
iam_policy_tags:
  ManagedBy: "Ansible"
  Environment: "{{ aws_environment | default('production') }}"
  Classification: "{{ data_classification | default('confidential') }}"
  Compliance: "FedRAMP-High"
  CostCenter: "{{ cost_center | default('IT-Security') }}"

# FedRAMP compliance policies
iam_create_fedramp_policies: true
iam_enforce_encryption: true
iam_restrict_regions: true

# Allowed GovCloud regions
iam_allowed_regions:
  - "us-gov-west-1"
  - "us-gov-east-1"

# Example policy list (override in inventory/playbook)
iam_policies: []
#  - name: "DeveloperPolicy"
#    description: "Policy for development team"
#    template: "developer_policy.json.j2"
#    versioning: true
#    tags:
#      Team: "Development"
#      Purpose: "Developer Access"
#    state: present

iam_boundary_policies: []
#  - name: "DeveloperBoundary"
#    max_permissions: "PowerUserAccess"
#    deny_actions:
#      - "iam:*"
#      - "organizations:*"
#    state: present

iam_service_policies: []
#  - service: "S3"
#    template: "s3_least_privilege.json.j2"
#  - service: "EC2"
#    template: "ec2_least_privilege.json.j2"

# FedRAMP required policies
iam_fedramp_policies:
  - name: "FedRAMP-DenyUnencryptedStorage"
    description: "Deny creation of unencrypted storage resources"
    template: "fedramp_deny_unencrypted.json.j2"
  - name: "FedRAMP-RequireMFA"
    description: "Require MFA for sensitive operations"
    template: "fedramp_require_mfa.json.j2"
  - name: "FedRAMP-AuditLogging"
    description: "Enforce CloudTrail and Config logging"
    template: "fedramp_audit_logging.json.j2"

iam_policy_attachments: []
#  - role: "EC2-Admin"
#    policies:
#      - "arn:aws-us-gov:iam::aws:policy/AmazonEC2FullAccess"
#      - "arn:aws-us-gov:iam::123456789012:policy/CustomPolicy"
