
- name: TP profile
  check_point.mgmt.cp_mgmt_threat_profile:
    name: "{{ tp_profile_name }}"
    active_protections: "recommended"
    optimize_security_profiles: "{{ (tp_profile_mode | default('optimized')) == 'optimized' }}"
    antivirus: "prevent"
    anti_bot: "prevent"
    ips:
      mode: "prevent"
      performance_impact: "medium_or_lower"
      severity: "medium_or_higher"
    comments: "{{ tp_profile_desc | default(omit) }}"
    state: present
