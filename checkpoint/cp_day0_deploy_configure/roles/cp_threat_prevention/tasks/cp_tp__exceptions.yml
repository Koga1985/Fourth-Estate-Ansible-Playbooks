
- name: TP exceptions
  check_point.mgmt.cp_mgmt_threat_exception:
    layer: "{{ tp_layer }}"
    name: "{{ item.name }}"
    position: "{{ item.position | default('top') }}"
    source: "{{ item.source | default(['Any']) }}"
    destination: "{{ item.destination | default(['Any']) }}"
    service: "{{ item.service | default(['Any']) }}"
    protections: "{{ item.protections | default(['Any']) }}"
    track: "{{ item.track | default('log') }}"
    time: "{{ (item.expiration is defined) | ternary({'type':'range','to': item.expiration}, omit) }}"
    comments: "{{ item.comments | default(omit) }}"
    tags: "{{ item.tags | default(omit) }}"
    enabled: "{{ item.enabled | default(true) }}"
    state: present
  loop: "{{ tp_exceptions | default([]) }}"
