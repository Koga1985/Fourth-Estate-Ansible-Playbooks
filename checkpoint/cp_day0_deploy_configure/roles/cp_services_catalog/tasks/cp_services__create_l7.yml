
- name: Categories
  when: (cp_app_categories | default([])) | length > 0
  check_point.mgmt.cp_mgmt_application_site_category:
    state: present
    name: "{{ item.name }}"
  loop: "{{ cp_app_categories | default([]) }}"
- name: App sites
  when: (cp_app_sites | default([])) | length > 0
  check_point.mgmt.cp_mgmt_application_site:
    state: present
    name: "{{ item.name }}"
    url_list: "{{ item.url_list | default([]) }}"
    primary_category: "{{ item.primary_category | default(omit) }}"
    additional_categories: "{{ item.additional_categories | default(omit) }}"
    risk: "{{ item.risk | default(omit) }}"
  loop: "{{ cp_app_sites | default([]) }}"
