
- name: TCP services
  when: (cp_services_tcp | default([])) | length > 0
  check_point.mgmt.cp_mgmt_service_tcp:
    state: present
    name: "{{ item.name }}"
    port: "{{ item.port }}"
    comments: "{{ item.comment | default(omit) }}"
  loop: "{{ cp_services_tcp | default([]) }}"
- name: UDP services
  when: (cp_services_udp | default([])) | length > 0
  check_point.mgmt.cp_mgmt_service_udp:
    state: present
    name: "{{ item.name }}"
    port: "{{ item.port }}"
    comments: "{{ item.comment | default(omit) }}"
  loop: "{{ cp_services_udp | default([]) }}"
