
- name: Apply rules
  check_point.mgmt.cp_mgmt_access_rule:
    layer: "{{ cp_layer }}"
    name: "{{ item.name }}"
    position: "{{ item.position | default('bottom') }}"
    source: "{{ item.source | default(['Any']) }}"
    destination: "{{ item.destination | default(['Any']) }}"
    service: "{{ item.service | default(['Any']) }}"
    action: "{{ item.action | default('Accept') }}"
    track: "{{ item.track | default('Log') }}"
    enabled: "{{ item.enabled | default(true) }}"
    tags: "{{ item.tags | default(omit) }}"
    state: present
  loop: "{{ cp_access_rules | default([]) }}"
