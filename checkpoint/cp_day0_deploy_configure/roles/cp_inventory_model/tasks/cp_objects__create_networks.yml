
- name: Network subnets
  when: (cp_networks | default([])) | length > 0
  check_point.mgmt.cp_mgmt_network:
    state: present
    name: "{{ item.name }}"
    subnet: "{{ item.subnet }}"
    mask_length: "{{ item.mask }}"
    color: "{{ item.color | default(omit) }}"
    comments: "{{ item.comment | default(omit) }}"
  loop: "{{ cp_networks | default([]) }}"
- name: Address ranges
  when: (cp_address_ranges | default([])) | length > 0
  check_point.mgmt.cp_mgmt_address_range:
    state: present
    name: "{{ item.name }}"
    ip_address_first: "{{ item.start }}"
    ip_address_last: "{{ item.end }}"
    color: "{{ item.color | default(omit) }}"
    comments: "{{ item.comment | default(omit) }}"
  loop: "{{ cp_address_ranges | default([]) }}"
