---
# Check Point Inventory Model Handlers

- name: Publish inventory changes
  check_point.mgmt.cp_mgmt_publish:
  listen: publish inventory

- name: Verify network objects
  check_point.mgmt.cp_mgmt_show_objects:
    type: "host"
    limit: 500
  listen: verify objects

- name: Export inventory to CSV
  ansible.builtin.template:
    src: inventory_export.j2
    dest: "{{ artifacts_dir | default('/tmp/checkpoint-artifacts') }}/inventory_export_{{ ansible_date_time.date }}.csv"
    mode: '0640'
  delegate_to: localhost
  listen: export inventory

- name: Backup network objects
  check_point.mgmt.cp_mgmt_api_call:
    command: "show-objects"
    parameters:
      type: "network"
  register: network_backup
  listen: backup network objects
