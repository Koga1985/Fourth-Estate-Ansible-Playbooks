# Check Point Access Rule Template
# Rule: {{ rule.name }}
# Generated: {{ ansible_date_time.iso8601 }}
# Layer: {{ cp_layer }}
# Package: {{ policy_package }}

Name: {{ rule.name }}
Position: {{ rule.position | default('bottom') }}
Source: {{ rule.source | default(['Any']) | join(', ') }}
Destination: {{ rule.destination | default(['Any']) | join(', ') }}
Service: {{ rule.service | default(['Any']) | join(', ') }}
Action: {{ rule.action | default('Drop') }}
Track: {{ rule.track | default('Log') }}
Enabled: {{ rule.enabled | default(true) | string | lower }}
{% if rule.time is defined %}
Time: {{ rule.time }}
{% endif %}
{% if rule.comments is defined %}
Comments: {{ rule.comments }}
{% endif %}
{% if rule.tags is defined %}
Tags: {{ rule.tags | join(', ') }}
{% endif %}
{% if rule.vpn is defined %}
VPN: {{ rule.vpn }}
{% endif %}
