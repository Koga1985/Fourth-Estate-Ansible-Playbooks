Check Point Access Policy - Rule Shadowing Analysis Report
Generated: {{ ansible_date_time.iso8601 }}
Policy Package: {{ policy_package }}
Layer: {{ cp_layer }}
Fourth Estate Security Review

Potentially Shadowed Rules:
Rule Name,Rule Number,Position,Shadowed By,Shadow Rule Number,Confidence,Impact,Recommendation
{% for shadow in shadowed_rules %}
{{ shadow.rule_name }},{{ shadow.rule_number }},{{ shadow.position }},{{ shadow.shadowed_by }},{{ shadow.shadow_rule_number }},{{ shadow.confidence }},{{ shadow.impact }},{{ shadow.recommendation }}
{% endfor %}

Shadowing Patterns Detected:
{% for pattern in shadowing_patterns %}
- {{ pattern.description }}
  Affected Rules: {{ pattern.affected_rules | join(', ') }}
  Risk Level: {{ pattern.risk_level }}
  Mitigation: {{ pattern.mitigation }}
{% endfor %}

Summary:
- Total Rules Analyzed: {{ total_rules }}
- High Confidence Shadows: {{ high_confidence_count }}
- Medium Confidence Shadows: {{ medium_confidence_count }}
- Low Confidence Shadows: {{ low_confidence_count }}
- Rules Requiring Immediate Attention: {{ immediate_attention_count }}

Analysis Notes:
- Shadowing occurs when a rule never matches because an earlier rule catches all its traffic
- High confidence shadows should be reviewed immediately
- Consider rule reordering or consolidation
- Verify business requirements before removing shadowed rules
- Document exceptions for intentional shadowing (defense in depth)

Compliance Requirements:
- DISA STIG NET-FW-020: Firewall rules must be logically ordered
- Fourth Estate: Rule base must be optimized for performance and security
- Quarterly review of rule ordering and effectiveness required

Security Review:
Analyst: _____________________  Date: _____________________
Reviewer: _____________________  Date: _____________________
Approver: _____________________  Date: _____________________
