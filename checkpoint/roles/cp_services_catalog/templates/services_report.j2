==========================================================================
              CHECK POINT SERVICES CATALOG REPORT
                 Fourth Estate Service Inventory
==========================================================================

Report Date: {{ ansible_date_time.iso8601 }}
Management Server: {{ ansible_host | default('Check Point Management') }}

TCP SERVICES
------------
{% if cp_services_tcp is defined and cp_services_tcp | length > 0 %}
Total TCP Services: {{ cp_services_tcp | length }}

Name,Port,Session Timeout,Comments
{% for svc in cp_services_tcp %}
{{ svc.name }},{{ svc.port }},{{ svc.session_timeout | default('Default') }},{{ svc.comment | default('') | replace(',', ';') }}
{% endfor %}
{% else %}
No custom TCP services configured
{% endif %}

UDP SERVICES
------------
{% if cp_services_udp is defined and cp_services_udp | length > 0 %}
Total UDP Services: {{ cp_services_udp | length }}

Name,Port,Session Timeout,Comments
{% for svc in cp_services_udp %}
{{ svc.name }},{{ svc.port }},{{ svc.session_timeout | default('Default') }},{{ svc.comment | default('') | replace(',', ';') }}
{% endfor %}
{% else %}
No custom UDP services configured
{% endif %}

APPLICATION/URL CATEGORIES
---------------------------
{% if cp_app_categories is defined and cp_app_categories | length > 0 %}
Total Application Categories: {{ cp_app_categories | length }}

{% for cat in cp_app_categories %}
- {{ cat.name }}: {{ cat.comment | default('Application category') }}
{% endfor %}
{% else %}
Using default Application Control categories
{% endif %}

APPLICATION SITES
-----------------
{% if cp_app_sites is defined and cp_app_sites | length > 0 %}
Total Application Sites: {{ cp_app_sites | length }}

Name,Category,Risk Level,URLs
{% for site in cp_app_sites %}
{{ site.name }},{{ site.primary_category | default('General') }},{{ site.risk | default('Unknown') }},{{ site.url_list | default([]) | join(';') }}
{% endfor %}
{% else %}
No custom application sites configured
{% endif %}

SUMMARY
-------
Total Custom Services: {{ (cp_services_tcp | default([]) | length) + (cp_services_udp | default([]) | length) }}
Total Custom Applications: {{ (cp_app_sites | default([]) | length) }}
Total Categories: {{ (cp_app_categories | default([]) | length) }}

COMPLIANCE NOTES
----------------
- All custom services must be documented in CMDB
- Application control required per Fourth Estate security policy
- High-risk applications must be blocked or monitored
- Service definitions must match IANA standards where applicable

==========================================================================
