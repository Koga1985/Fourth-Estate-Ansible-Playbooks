---
# Check Point Services Catalog Handlers

- name: Publish services
  check_point.mgmt.cp_mgmt_publish:
  listen: publish services

- name: Verify service objects
  check_point.mgmt.cp_mgmt_show_services_tcp:
    limit: 500
  listen: verify tcp services

- name: Generate service catalog report
  ansible.builtin.template:
    src: services_report.j2
    dest: "{{ artifacts_dir | default('/tmp/checkpoint-artifacts') }}/services_catalog_{{ ansible_date_time.date }}.txt"
    mode: '0640'
  delegate_to: localhost
  listen: generate services report
