---
# Enable Identity Awareness on gateways/clusters.
# Vars:
#   ia_gateways:
#     - { name: "dc-gw1", identity_aware: true }
#     - { name: "branch-gw", identity_aware: true }
#   publish_changes: false

- name: Enable IA on simple gateways
  check_point.mgmt.cp_mgmt_simple_gateway:
    name: "{{ item.name }}"
    identity_aware: "{{ item.identity_aware | default(true) }}"
    state: present
  loop: "{{ ia_gateways | default([]) }}"
  loop_control: { label: "{{ item.name }}" }

- name: Publish IA toggle
  when: publish_changes | default(false) | bool
  check_point.mgmt.cp_mgmt_publish:
