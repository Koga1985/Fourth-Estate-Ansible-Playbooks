---
# Configure HTTPS Inspection certificate settings.
# Works with the generic API for broad R8x support.
# Vars:
#   https_ca_settings:
#     enabled: true
#     certificate_type: "internal"   # internal | pki
#     ca_name: "HTTPS-INSPECT-CA"    # for internal
#     trust_chain: |                 # optional PEM chain for PKI
#       -----BEGIN CERTIFICATE-----
#       ...
#       -----END CERTIFICATE-----

- name: Set HTTPS Inspection certificate settings
  check_point.mgmt.cp_mgmt_api_call:
    command: "set-https-inspection"
    parameters:
      enabled: "{{ https_ca_settings.enabled | default(true) }}"
      certificate-type: "{{ https_ca_settings.certificate_type | default('internal') }}"
      ca: "{{ https_ca_settings.ca_name | default(omit) }}"
      trust-chain: "{{ https_ca_settings.trust_chain | default(omit) }}"

- name: Publish HTTPS CA config
  check_point.mgmt.cp_mgmt_publish:
