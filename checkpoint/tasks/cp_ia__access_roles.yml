---
# Create/Update Access Roles (used in identity-based rules).
# Vars:
#   ia_access_roles:
#     - name: "Role-IT-Admins"
#       users: ["CN=IT Admins,OU=Groups,DC=corp,DC=local"]   # AD groups/users
#       machines: ["it-admin-laptops"]                       # network/host/grp names
#       networks: ["corp-lan"]
#       comments: "IT admins role"
#   publish_changes: false

- name: Create/Update access roles
  check_point.mgmt.cp_mgmt_access_role:
    state: present
    name: "{{ item.name }}"
    users: "{{ item.users | default(omit) }}"
    machines: "{{ item.machines | default(omit) }}"
    networks: "{{ item.networks | default(omit) }}"
    comments: "{{ item.comments | default(omit) }}"
  loop: "{{ ia_access_roles | default([]) }}"
  loop_control: { label: "{{ item.name }}" }

- name: Publish access roles
  when: publish_changes | default(false) | bool
  check_point.mgmt.cp_mgmt_publish:
