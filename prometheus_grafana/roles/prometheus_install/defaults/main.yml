---
# Prometheus Installation Role - Default Variables
# Fourth Estate Agency - Infrastructure Monitoring

# Prometheus version
prometheus_version: "2.48.0"
prometheus_download_url: "https://github.com/prometheus/prometheus/releases/download/v{{ prometheus_version }}/prometheus-{{ prometheus_version }}.linux-amd64.tar.gz"

# Installation paths
prometheus_install_dir: "/opt/prometheus"
prometheus_config_dir: "/etc/prometheus"
prometheus_data_dir: "/var/lib/prometheus"
prometheus_log_dir: "/var/log/prometheus"

# System user and group
prometheus_user: "prometheus"
prometheus_group: "prometheus"
prometheus_uid: 9090
prometheus_gid: 9090

# Service configuration
prometheus_listen_address: "0.0.0.0:9090"
prometheus_web_external_url: "http://{{ ansible_fqdn }}:9090"
prometheus_enable_admin_api: false
prometheus_enable_lifecycle: true

# Storage configuration
prometheus_storage_retention_time: "15d"
prometheus_storage_retention_size: "50GB"
prometheus_storage_tsdb_path: "{{ prometheus_data_dir }}"
prometheus_storage_wal_compression: true

# Performance tuning
prometheus_max_samples_per_send: 500
prometheus_max_samples_per_query: 50000000
prometheus_query_timeout: "2m"
prometheus_query_max_concurrency: 20

# Security configuration
prometheus_enable_tls: false
prometheus_tls_cert_file: "{{ prometheus_config_dir }}/tls/prometheus.crt"
prometheus_tls_key_file: "{{ prometheus_config_dir }}/tls/prometheus.key"

prometheus_enable_basic_auth: true
prometheus_basic_auth_users:
  - username: "admin"
    password: "{{ vault_prometheus_admin_password | default('changeme') }}"

# Firewall configuration
prometheus_firewall_enabled: true
prometheus_firewall_zone: "public"
prometheus_firewall_ports:
  - "9090/tcp"

# SELinux configuration
prometheus_selinux_enabled: true
prometheus_selinux_ports:
  - port: 9090
    proto: tcp
    setype: prometheus_port_t

# Log configuration
prometheus_log_level: "info"
prometheus_log_format: "logfmt"

# Systemd service configuration
prometheus_service_enabled: true
prometheus_service_state: started
prometheus_restart_on_change: true

# High availability
prometheus_ha_enabled: false
prometheus_ha_replica_id: "{{ inventory_hostname }}"

# Remote write configuration (for long-term storage)
prometheus_remote_write_enabled: false
prometheus_remote_write_url: ""
prometheus_remote_write_basic_auth_username: ""
prometheus_remote_write_basic_auth_password: ""

# Remote read configuration
prometheus_remote_read_enabled: false
prometheus_remote_read_url: ""

# Feature flags
prometheus_feature_flags: []
# Example: ['promql-at-modifier', 'promql-negative-offset']

# Additional command line arguments
prometheus_additional_args: []

# Package dependencies
prometheus_dependencies:
  - curl
  - tar
  - gzip
  - policycoreutils-python-utils

# Backup configuration
prometheus_backup_enabled: true
prometheus_backup_dir: "/backup/prometheus"
prometheus_backup_retention_days: 7

# Compliance and auditing
prometheus_audit_enabled: true
prometheus_compliance_mode: "fips"  # fips, hipaa, or standard

# Fourth Estate specific settings
prometheus_organization: "fourth_estate"
prometheus_environment: "{{ environment | default('production') }}"
prometheus_tags:
  organization: "fourth_estate"
  managed_by: "ansible"
  role: "monitoring"
