---
# Prometheus Exporters Role - Default Variables
# Fourth Estate Agency - Infrastructure Monitoring

# Node Exporter configuration
node_exporter_enabled: true
node_exporter_version: "1.7.0"
node_exporter_download_url: "https://github.com/prometheus/node_exporter/releases/download/v{{ node_exporter_version }}/node_exporter-{{ node_exporter_version }}.linux-amd64.tar.gz"
node_exporter_install_dir: "/opt/node_exporter"
node_exporter_listen_address: "0.0.0.0:9100"
node_exporter_user: "node_exporter"
node_exporter_group: "node_exporter"

node_exporter_enabled_collectors:
  - systemd
  - processes
  - interrupts
  - tcpstat
  - filesystem
  - diskstats
  - netdev
  - netstat
  - vmstat
  - meminfo
  - cpu
  - loadavg

node_exporter_disabled_collectors:
  - arp
  - bonding
  - edac
  - ipvs
  - mdadm
  - nfs
  - nfsd
  - zfs

# Blackbox Exporter configuration
blackbox_exporter_enabled: true
blackbox_exporter_version: "0.24.0"
blackbox_exporter_download_url: "https://github.com/prometheus/blackbox_exporter/releases/download/v{{ blackbox_exporter_version }}/blackbox_exporter-{{ blackbox_exporter_version }}.linux-amd64.tar.gz"
blackbox_exporter_install_dir: "/opt/blackbox_exporter"
blackbox_exporter_config_dir: "/etc/blackbox_exporter"
blackbox_exporter_listen_address: "0.0.0.0:9115"
blackbox_exporter_user: "blackbox_exporter"
blackbox_exporter_group: "blackbox_exporter"

blackbox_exporter_modules:
  http_2xx:
    prober: http
    timeout: 5s
    http:
      valid_http_versions: ["HTTP/1.1", "HTTP/2.0"]
      valid_status_codes: []
      method: GET
      preferred_ip_protocol: "ip4"
      fail_if_ssl: false
      fail_if_not_ssl: false
      tls_config:
        insecure_skip_verify: false

  http_post_2xx:
    prober: http
    timeout: 5s
    http:
      method: POST
      valid_status_codes: [200, 201, 202]

  tcp_connect:
    prober: tcp
    timeout: 5s

  icmp:
    prober: icmp
    timeout: 5s
    icmp:
      preferred_ip_protocol: "ip4"

  dns:
    prober: dns
    timeout: 5s
    dns:
      preferred_ip_protocol: "ip4"
      query_name: "example.com"
      query_type: "A"

# PostgreSQL Exporter configuration
postgres_exporter_enabled: false
postgres_exporter_version: "0.15.0"
postgres_exporter_download_url: "https://github.com/prometheus-community/postgres_exporter/releases/download/v{{ postgres_exporter_version }}/postgres_exporter-{{ postgres_exporter_version }}.linux-amd64.tar.gz"
postgres_exporter_install_dir: "/opt/postgres_exporter"
postgres_exporter_listen_address: "0.0.0.0:9187"
postgres_exporter_user: "postgres_exporter"
postgres_exporter_group: "postgres_exporter"
postgres_exporter_data_source_name: "postgresql://postgres_exporter:{{ vault_postgres_exporter_password | default('changeme') }}@localhost:5432/postgres?sslmode=disable"

# MySQL Exporter configuration
mysql_exporter_enabled: false
mysql_exporter_version: "0.15.1"
mysql_exporter_download_url: "https://github.com/prometheus/mysqld_exporter/releases/download/v{{ mysql_exporter_version }}/mysqld_exporter-{{ mysql_exporter_version }}.linux-amd64.tar.gz"
mysql_exporter_install_dir: "/opt/mysql_exporter"
mysql_exporter_listen_address: "0.0.0.0:9104"
mysql_exporter_user: "mysql_exporter"
mysql_exporter_group: "mysql_exporter"
mysql_exporter_data_source_name: "mysql_exporter:{{ vault_mysql_exporter_password | default('changeme') }}@(localhost:3306)/"

# Redis Exporter configuration
redis_exporter_enabled: false
redis_exporter_version: "1.55.0"
redis_exporter_download_url: "https://github.com/oliver006/redis_exporter/releases/download/v{{ redis_exporter_version }}/redis_exporter-v{{ redis_exporter_version }}.linux-amd64.tar.gz"
redis_exporter_install_dir: "/opt/redis_exporter"
redis_exporter_listen_address: "0.0.0.0:9121"
redis_exporter_user: "redis_exporter"
redis_exporter_group: "redis_exporter"
redis_exporter_redis_addr: "redis://localhost:6379"

# NGINX Exporter configuration
nginx_exporter_enabled: false
nginx_exporter_version: "0.11.0"
nginx_exporter_download_url: "https://github.com/nginxinc/nginx-prometheus-exporter/releases/download/v{{ nginx_exporter_version }}/nginx-prometheus-exporter_{{ nginx_exporter_version }}_linux_amd64.tar.gz"
nginx_exporter_install_dir: "/opt/nginx_exporter"
nginx_exporter_listen_address: "0.0.0.0:9113"
nginx_exporter_user: "nginx_exporter"
nginx_exporter_group: "nginx_exporter"
nginx_exporter_scrape_uri: "http://localhost:80/stub_status"

# Firewall configuration
exporters_firewall_enabled: true
exporters_firewall_zone: "public"
exporters_firewall_ports:
  - "9100/tcp"  # Node Exporter
  - "9115/tcp"  # Blackbox Exporter
  - "9187/tcp"  # PostgreSQL Exporter
  - "9104/tcp"  # MySQL Exporter
  - "9121/tcp"  # Redis Exporter
  - "9113/tcp"  # NGINX Exporter

# SELinux configuration
exporters_selinux_enabled: true

# Service configuration
exporters_service_enabled: true
exporters_service_state: started
exporters_restart_on_change: true

# Fourth Estate specific settings
exporters_organization: "fourth_estate"
exporters_environment: "{{ environment | default('production') }}"
