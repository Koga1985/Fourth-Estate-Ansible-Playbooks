# Blackbox Exporter Service Discovery
# Managed by Ansible - Fourth Estate Agency
# {{ ansible_managed }}

{% for target in prometheus_blackbox_targets | default([]) %}
- targets:
    - '{{ target.url }}'
  labels:
    environment: '{{ target.environment | default(prometheus_external_labels.environment) }}'
    service: '{{ target.service | default("web") }}'
    check_type: '{{ target.check_type | default("http_2xx") }}'
{% if target.labels is defined %}
{% for key, value in target.labels.items() %}
    {{ key }}: '{{ value }}'
{% endfor %}
{% endif %}
{% endfor %}
