---
# Configure compliance settings
- name: Enable compliance mode
  ansible.builtin.uri:
    url: "{{ cohesity_api_protocol }}://{{ cohesity_cluster_vip }}/irisservices/api/v1/public/cluster/complianceConfig"
    method: PUT
    headers:
      Authorization: "Bearer {{ cohesity_api_token }}"
    body_format: json
    body:
      enableComplianceMode: "{{ cohesity_compliance_settings.enable_compliance_mode }}"
      enableWorm: "{{ cohesity_compliance_settings.enable_worm }}"
      wormRetentionDays: "{{ cohesity_compliance_settings.worm_retention_period_days }}"
      enableAuditTrail: "{{ cohesity_compliance_settings.enable_audit_trail }}"
      auditExportEnabled: "{{ cohesity_compliance_settings.audit_export_enabled }}"
    validate_certs: "{{ cohesity_api_verify_ssl }}"
    status_code: 200
