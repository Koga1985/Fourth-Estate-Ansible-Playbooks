---
# Configure ransomware protection settings
- name: Enable ransomware threat detection
  ansible.builtin.uri:
    url: "{{ cohesity_api_protocol }}://{{ cohesity_cluster_vip }}/irisservices/api/v1/public/cluster/threatDetection"
    method: PUT
    headers:
      Authorization: "Bearer {{ cohesity_api_token }}"
    body_format: json
    body:
      enableThreatDetection: "{{ cohesity_ransomware_protection.enable_threat_detection }}"
      enableAnomalyDetection: "{{ cohesity_ransomware_protection.enable_anomaly_detection }}"
      enableFileScanning: "{{ cohesity_ransomware_protection.enable_file_scanning }}"
      quarantineSuspiciousFiles: "{{ cohesity_ransomware_protection.quarantine_suspicious_files }}"
    validate_certs: "{{ cohesity_api_verify_ssl }}"
    status_code: 200
