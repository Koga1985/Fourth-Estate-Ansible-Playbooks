---
# Configure SNMP
- name: Configure SNMPv3
  ansible.builtin.uri:
    url: "{{ cohesity_api_protocol }}://{{ cohesity_cluster_vip }}/irisservices/api/v1/public/snmpConfig"
    method: PUT
    headers:
      Authorization: "Bearer {{ cohesity_api_token }}"
    body_format: json
    body:
      version: "{{ cohesity_snmp_version }}"
      snmpv3Config:
        username: "{{ cohesity_snmp_user }}"
        authProtocol: "{{ cohesity_snmp_auth_protocol }}"
        authPassword: "{{ cohesity_snmp_auth_password }}"
        privacyProtocol: "{{ cohesity_snmp_privacy_protocol }}"
        privacyPassword: "{{ cohesity_snmp_privacy_password }}"
      trapReceivers: "{{ cohesity_snmp_trap_receivers }}"
    validate_certs: "{{ cohesity_api_verify_ssl }}"
    status_code: 200
  no_log: true
