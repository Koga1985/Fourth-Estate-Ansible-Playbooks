---
# defaults file for cohesity_cluster_config

# Cohesity Cluster Connection
cohesity_cluster_vip: "10.100.1.100"
cohesity_api_protocol: "https"
cohesity_api_port: 443
cohesity_api_verify_ssl: true
cohesity_api_timeout: 300

# Authentication
cohesity_admin_username: "admin"
cohesity_admin_password: "{{ vault_cohesity_admin_password }}"
cohesity_api_token: ""

# Active Directory Configuration
cohesity_ad_enabled: true
cohesity_ad_domain: "fourthestate.com"
cohesity_ad_preferred_dc: []
cohesity_ad_username: "cohesity-svc@fourthestate.com"
cohesity_ad_password: "{{ vault_ad_password }}"
cohesity_ad_ou_path: "OU=Service Accounts,DC=fourthestate,DC=com"
cohesity_ad_trusted_domains: []
cohesity_ad_workgroup: ""
cohesity_ad_ldap_provider: "OpenLdap"
cohesity_ad_user_id_mapping: "SFU"  # SFU, RFC2307, Centrify, Custom

# LDAP Configuration
cohesity_ldap_enabled: false
cohesity_ldap_server: "ldap.fourthestate.com"
cohesity_ldap_port: 636
cohesity_ldap_use_ssl: true
cohesity_ldap_base_dn: "dc=fourthestate,dc=com"
cohesity_ldap_bind_dn: "cn=cohesity,ou=service accounts,dc=fourthestate,dc=com"
cohesity_ldap_bind_password: "{{ vault_ldap_password }}"
cohesity_ldap_user_search_filter: "(objectClass=person)"
cohesity_ldap_group_search_filter: "(objectClass=group)"

# Kerberos Configuration
cohesity_kerberos_enabled: true
cohesity_kerberos_realm: "FOURTHESTATE.COM"
cohesity_kerberos_kdc_servers:
  - "kdc1.fourthestate.com"
  - "kdc2.fourthestate.com"

# User Management
cohesity_local_users:
  - username: "backup-operator"
    password: "{{ vault_backup_operator_password }}"
    email: "backup-ops@fourthestate.com"
    roles: ["COHESITY_VIEWER", "COHESITY_ADMIN"]
    description: "Backup operations account"
  - username: "security-admin"
    password: "{{ vault_security_admin_password }}"
    email: "security@fourthestate.com"
    roles: ["COHESITY_ADMIN"]
    description: "Security administration account"

# RBAC Configuration
cohesity_ad_groups:
  - group_name: "Cohesity-Admins"
    domain: "fourthestate.com"
    roles: ["COHESITY_ADMIN"]
    description: "Full administrative access"
  - group_name: "Cohesity-Operators"
    domain: "fourthestate.com"
    roles: ["COHESITY_VIEWER", "DATA_PROTECTION_ADMIN"]
    description: "Backup and recovery operations"
  - group_name: "Cohesity-Viewers"
    domain: "fourthestate.com"
    roles: ["COHESITY_VIEWER"]
    description: "Read-only access"

# Privileges and Custom Roles
cohesity_custom_roles:
  - name: "JournalistRecovery"
    description: "File recovery for journalist workstations"
    privileges:
      - "VIEW_PROTECTION_JOBS"
      - "RESTORE_FILES"
      - "VIEW_OBJECTS"
  - name: "CMSAdmin"
    description: "CMS backup and recovery"
    privileges:
      - "VIEW_PROTECTION_JOBS"
      - "MANAGE_PROTECTION_JOBS"
      - "RESTORE_FILES"
      - "RESTORE_VMS"
      - "RESTORE_APPS"

# Storage Domains (View Boxes)
cohesity_storage_domains:
  - name: "ProductionStorageDomain"
    compression: "kCompressionLow"
    deduplication_enabled: true
    encryption_policy: "kEncryptionStrong"
    inline_dedupe: true
    inline_compression: true
    num_failures_tolerated: 2
    physical_quota_hard_limit_bytes: 107374182400000  # 100TB
  - name: "ArchiveStorageDomain"
    compression: "kCompressionHigh"
    deduplication_enabled: true
    encryption_policy: "kEncryptionStrong"
    inline_dedupe: true
    inline_compression: true
    num_failures_tolerated: 1
    physical_quota_hard_limit_bytes: 214748364800000  # 200TB

# Syslog Configuration
cohesity_syslog_enabled: true
cohesity_syslog_servers:
  - server: "syslog.fourthestate.com"
    port: 514
    protocol: "TCP"
    name: "PrimarySyslog"
  - server: "syslog-backup.fourthestate.com"
    port: 514
    protocol: "TCP"
    name: "BackupSyslog"

# SNMP Configuration
cohesity_snmp_enabled: true
cohesity_snmp_version: "v3"
cohesity_snmp_user: "cohesity-snmp"
cohesity_snmp_auth_protocol: "SHA"
cohesity_snmp_auth_password: "{{ vault_snmp_auth_password }}"
cohesity_snmp_privacy_protocol: "AES128"
cohesity_snmp_privacy_password: "{{ vault_snmp_privacy_password }}"
cohesity_snmp_trap_receivers:
  - host: "snmp-receiver.fourthestate.com"
    port: 162
    version: "v3"

# Certificate Management
cohesity_ssl_certificate_enabled: true
cohesity_ssl_certificate_type: "custom"  # self-signed, custom, acme
cohesity_ssl_certificate_path: "/etc/ssl/certs/cohesity.crt"
cohesity_ssl_private_key_path: "/etc/ssl/private/cohesity.key"
cohesity_ssl_ca_chain_path: "/etc/ssl/certs/ca-bundle.crt"

# Security Settings
cohesity_security_settings:
  enable_multi_factor_auth: true
  password_min_length: 14
  password_complexity: true
  password_expiry_days: 90
  session_timeout_minutes: 30
  max_failed_login_attempts: 5
  lockout_duration_minutes: 30
  enable_audit_logging: true
  audit_log_retention_days: 365

# IP Allowlist/Denylist
cohesity_ip_allowlist_enabled: true
cohesity_ip_allowlist:
  - "10.100.0.0/16"
  - "192.168.1.0/24"
  - "172.16.0.0/12"
cohesity_ip_denylist_enabled: false
cohesity_ip_denylist: []

# Multi-tenancy Configuration
cohesity_multi_tenancy_enabled: true
cohesity_organizations:
  - name: "NewsDesk"
    description: "News department data protection"
    view_box_name: "ProductionStorageDomain"
    ad_group: "Cohesity-NewsDesk"
  - name: "Editorial"
    description: "Editorial department data protection"
    view_box_name: "ProductionStorageDomain"
    ad_group: "Cohesity-Editorial"

# Global Settings
cohesity_global_settings:
  enable_banner_message: true
  banner_message: "WARNING: Authorized access only. All activity is monitored and logged."
  enable_chassis_manager: false
  enable_patch_management: true
  enable_remote_tunnel: false
  timezone: "America/New_York"
  language: "en-US"

# Email Notification Settings
cohesity_email_notifications:
  - event_type: "ProtectionJobFailed"
    recipients:
      - "backup-alerts@fourthestate.com"
    severity: "Critical"
  - event_type: "DataLockSnapshotDeleted"
    recipients:
      - "security@fourthestate.com"
      - "compliance@fourthestate.com"
    severity: "Critical"
  - event_type: "StorageUsageExceeded"
    recipients:
      - "backup-ops@fourthestate.com"
    severity: "Warning"
    threshold_percent: 80

# Ransomware Protection Settings
cohesity_ransomware_protection:
  enable_threat_detection: true
  enable_anomaly_detection: true
  enable_datalock: true
  datalock_retention_days: 365
  enable_snapshot_immutability: true
  min_retention_days: 30
  enable_file_scanning: true
  quarantine_suspicious_files: true

# Compliance Settings for Fourth Estate
cohesity_compliance_settings:
  enable_legal_hold: true
  enable_worm: true
  worm_retention_period_days: 2555  # 7 years
  enable_compliance_mode: true
  enable_encryption_key_rotation: true
  key_rotation_days: 90
  enable_audit_trail: true
  audit_export_enabled: true
  audit_export_retention_years: 7

# Cluster Preferences
cohesity_cluster_preferences:
  enable_fips_mode: true
  enable_hipaa_mode: false
  enable_compression_global: true
  enable_deduplication_global: true
  enable_inline_dedupe: true
  enable_inline_compression: true
  default_view_quota_policy: "AlertOnly"

# Network Configuration
cohesity_network_interface_groups:
  - name: "Production"
    vlan_id: 100
    subnet: "10.100.1.0/24"
    gateway: "10.100.1.1"
    mtu: 9000
  - name: "Replication"
    vlan_id: 200
    subnet: "10.200.1.0/24"
    gateway: "10.200.1.1"
    mtu: 9000

# Quality of Service (QoS)
cohesity_qos_policies:
  - name: "Critical"
    priority: "kHigh"
    principal_name: "Cohesity-Admins@fourthestate.com"
  - name: "Standard"
    priority: "kMedium"
    principal_name: "Cohesity-Operators@fourthestate.com"

# Maintenance Windows
cohesity_maintenance_windows:
  - day_of_week: "Saturday"
    start_time: "22:00"
    end_time: "04:00"
    timezone: "America/New_York"
  - day_of_week: "Sunday"
    start_time: "22:00"
    end_time: "04:00"
    timezone: "America/New_York"

# Fourth Estate Specific
cohesity_fourth_estate_config:
  enable_source_protection: true
  journalist_workstation_tag: "journalist"
  cms_tag: "cms"
  media_archive_tag: "media"
  enable_content_search: true
  enable_legal_hold_workflow: true
  retention_policy_enforcement: "strict"
