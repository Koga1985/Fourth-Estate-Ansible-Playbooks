---
# F5 BIG-IP SSL Certificate Management - Default Variables
# Fourth Estate Production Standards

# F5 BIG-IP Connection Details
f5_bigip_provider:
  server: "{{ f5_bigip_host | default(ansible_host) }}"
  user: "{{ f5_bigip_username | default('admin') }}"
  password: "{{ f5_bigip_password }}"
  server_port: "{{ f5_bigip_port | default(443) }}"
  validate_certs: "{{ f5_bigip_validate_certs | default(true) }}"
  transport: rest

# SSL Certificates Configuration
f5_bigip_ssl_certificates: []
# Example SSL Certificate configuration:
# f5_bigip_ssl_certificates:
#   - name: www_example_com
#     cert_content: "{{ lookup('file', '/path/to/cert.crt') }}"
#     key_content: "{{ lookup('file', '/path/to/cert.key') }}"
#     passphrase: "{{ vault_ssl_passphrase | default(omit) }}"
#     partition: Common
#   - name: wildcard_agency_gov
#     cert_content: "{{ lookup('file', '/path/to/wildcard.crt') }}"
#     key_content: "{{ lookup('file', '/path/to/wildcard.key') }}"
#     chain_content: "{{ lookup('file', '/path/to/chain.crt') }}"

# SSL Key Management
f5_bigip_ssl_keys: []
# Example SSL Key configuration (if managing separately):
# f5_bigip_ssl_keys:
#   - name: private_key_1
#     key_content: "{{ lookup('file', '/path/to/key.pem') }}"
#     passphrase: "{{ vault_key_passphrase | default(omit) }}"
#     security: normal  # Options: normal, password, fips

# Client SSL Profiles
f5_bigip_client_ssl_profiles: []
# Example Client SSL Profile:
# f5_bigip_client_ssl_profiles:
#   - name: clientssl_secure
#     parent: clientssl
#     cert_key_chain:
#       - cert: www_example_com
#         key: www_example_com
#         chain: ca_bundle
#     ciphers: "DEFAULT:!aNULL:!eNULL:!LOW:!RC4:!MD5:!EXP:!PSK:!SRP:!DSS"
#     options:
#       - no-tlsv1
#       - no-tlsv1.1
#       - no-sslv2
#       - no-sslv3
#     sni_default: true
#     sni_require: false

# Server SSL Profiles
f5_bigip_server_ssl_profiles: []
# Example Server SSL Profile:
# f5_bigip_server_ssl_profiles:
#   - name: serverssl_secure
#     parent: serverssl
#     ciphers: "DEFAULT:!aNULL:!eNULL:!LOW:!RC4:!MD5:!EXP"
#     options:
#       - no-tlsv1
#       - no-tlsv1.1
#     peer_cert_mode: ignore

# Default SSL Cipher Suite (DISA STIG Compliant)
f5_bigip_ssl_default_ciphers: "ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:AES256-GCM-SHA384:AES128-GCM-SHA256:AES256-SHA256:AES128-SHA256"

# SSL Protocol Versions (TLS 1.2+ only)
f5_bigip_ssl_protocols:
  - no-sslv2
  - no-sslv3
  - no-tlsv1
  - no-tlsv1.1

# OCSP Configuration
f5_bigip_ocsp_enabled: true
f5_bigip_ocsp_stapling: true

# Certificate Bundles (CA bundles)
f5_bigip_ssl_cert_bundles: []
# Example CA Bundle:
# f5_bigip_ssl_cert_bundles:
#   - name: ca_bundle
#     bundle_content: "{{ lookup('file', '/path/to/ca-bundle.crt') }}"

# SNI Configuration
f5_bigip_sni_enabled: true
f5_bigip_sni_require: false

# Session Renegotiation
f5_bigip_ssl_renegotiation: false
f5_bigip_ssl_secure_renegotiation: require-strict

# Certificate Expiration Monitoring
f5_bigip_cert_expiry_warning_days: 30

# SSL Options
f5_bigip_ssl_insert_empty_fragments: true
f5_bigip_ssl_single_dh_use: true

# Session Tickets
f5_bigip_ssl_session_ticket: false

# Save Configuration
f5_bigip_save_config: true
