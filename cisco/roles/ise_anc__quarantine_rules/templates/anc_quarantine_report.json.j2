{
  "report_type": "ise_anc_quarantine",
  "generated_at": "{{ ansible_date_time.iso8601 }}",
  "generated_by": "{{ ansible_user_id }}@{{ ansible_hostname }}",
  "ise_deployment": {
    "hostname": "{{ ise_hostname }}",
    "organization": "{{ fourth_estate_org }}",
    "contact": "{{ fourth_estate_contact }}"
  },
  "anc_policies": {
    "total_configured": {{ anc_policies | length }},
    "enabled": {{ anc_policies | selectattr('enabled', 'defined') | selectattr('enabled') | list | length }},
    "policies": {{ anc_policies | to_nice_json }}
  },
  "disa_stig_compliance": {
    "enabled": {{ enable_disa_stig_compliance | lower }},
    "policies": {{ disa_stig_anc_policies | to_nice_json }}
  },
  "endpoint_assignments": {
    "total": {{ anc_endpoint_assignments | length }},
    "assignments": {{ anc_endpoint_assignments | to_nice_json }}
  },
  "exceptions": {
    "total": {{ anc_exceptions | length }},
    "exempted_devices": {{ anc_exceptions | to_nice_json }}
  },
  "configuration": {
    "auto_quarantine_enabled": {{ anc_auto_quarantine_enabled | lower }},
    "siem_integration": {{ anc_siem_integration_enabled | lower }},
    "default_quarantine_duration": {{ anc_default_quarantine_duration }},
    "max_quarantine_duration": {{ anc_max_quarantine_duration }},
    "auto_remediation": {{ anc_enable_auto_remediation | lower }}
  },
  "compliance_frameworks": {{ compliance_frameworks | to_nice_json }}
}
