---
# defaults file for ise_anc__quarantine_rules
# Cisco ISE Adaptive Network Control (ANC) Quarantine Rules

# ISE Connection Parameters
ise_hostname: "{{ vault_ise_hostname }}"
ise_username: "{{ vault_ise_username }}"
ise_password: "{{ vault_ise_password }}"
ise_verify_ssl: true
ise_use_proxy: false
ise_debug: false

# Deployment Control
apply_changes: false
ise_artifacts_dir: "/tmp/ise-artifacts"

# Fourth Estate Configuration
fourth_estate_org: "FourthEstate"
fourth_estate_contact: "{{ vault_fourth_estate_contact }}"

# ANC Quarantine Policies
anc_policies:
  - name: "QUARANTINE"
    actions:
      - "QUARANTINE"
    description: "Standard quarantine policy for compromised endpoints"
    enabled: true
  - name: "PORT_BOUNCE"
    actions:
      - "PORT_BOUNCE"
    description: "Port bounce for remediation"
    enabled: true
  - name: "SHUTDOWN"
    actions:
      - "SHUTDOWN"
    description: "Complete port shutdown for critical threats"
    enabled: false

# DISA STIG Compliance ANC Policies
enable_disa_stig_compliance: true
disa_stig_anc_policies:
  - name: "STIG-QUARANTINE-HIGH"
    actions:
      - "QUARANTINE"
      - "RE_AUTHENTICATE"
    description: "STIG-compliant quarantine for high-risk endpoints"
    enabled: true
  - name: "STIG-ISOLATE-CRITICAL"
    actions:
      - "SHUTDOWN"
    description: "STIG-compliant isolation for critical threats"
    enabled: true

# ANC Endpoint Assignments (manual quarantine assignments)
anc_endpoint_assignments: []
# Example:
# anc_endpoint_assignments:
#   - mac_address: "00:11:22:33:44:55"
#     policy_name: "QUARANTINE"
#     reason: "Malware detected"
#   - mac_address: "00:11:22:33:44:66"
#     policy_name: "PORT_BOUNCE"
#     reason: "Failed posture assessment"

# ANC Exceptions (devices exempt from automatic quarantine)
anc_exceptions: []
# Example:
# anc_exceptions:
#   - mac_address: "AA:BB:CC:DD:EE:FF"
#     reason: "Critical infrastructure device"
#     approved_by: "Security Team"
#     expiry_date: "2026-12-31"
#     enabled: true

# Automated Threat Response
anc_auto_quarantine_enabled: true
anc_auto_quarantine_threats:
  - "malware_detected"
  - "posture_failed"
  - "unauthorized_access"
  - "policy_violation"

# Integration with SIEM
anc_siem_integration_enabled: true
anc_siem_endpoint: "{{ vault_siem_endpoint }}"

# Notification Settings
anc_notify_on_quarantine: true
anc_notification_email: "{{ vault_security_team_email }}"

# Compliance Frameworks
compliance_frameworks:
  - "dod_stig"
  - "nist_800_53"
  - "nist_800_171"
  - "fisma_moderate"

# Logging
anc_log_level: "INFO"
anc_log_to_syslog: true
anc_syslog_server: "{{ vault_syslog_server }}"

# Quarantine Duration
anc_default_quarantine_duration: 86400  # 24 hours in seconds
anc_max_quarantine_duration: 604800     # 7 days in seconds

# Remediation Settings
anc_enable_auto_remediation: false
anc_remediation_portal_url: "https://{{ ise_hostname }}/remediation"
