---
# defaults file for ise_audit__config_changes
# Cisco ISE Configuration Change Auditing and Compliance Tracking

# ISE Connection Parameters
ise_hostname: "{{ vault_ise_hostname }}"
ise_username: "{{ vault_ise_username }}"
ise_password: "{{ vault_ise_password }}"
ise_verify_ssl: true
ise_use_proxy: false
ise_debug: false

# Deployment Control
apply_changes: false
ise_artifacts_dir: "/tmp/ise-artifacts"

# Fourth Estate Configuration
fourth_estate_org: "FourthEstate"
fourth_estate_contact: "{{ vault_fourth_estate_contact }}"

# Audit Configuration
audit_start_date: "{{ (ansible_date_time.epoch | int - 86400) | int }}"  # Last 24 hours
audit_end_date: "{{ ansible_date_time.epoch }}"
audit_lookback_minutes: 1440  # 24 hours

# Audit Categories
audit_change_categories:
  - "Policy"
  - "Network Device"
  - "Endpoint"
  - "Identity Store"
  - "Admin Access"
  - "System Configuration"
  - "Certificate"
  - "Guest Services"
  - "Profiling"
  - "Posture"
  - "TrustSec"
  - "pxGrid"

# API Audit
ise_enable_api_audit: true

# Authorized Admin Users
authorized_admin_users:
  - "admin"
  - "{{ vault_ise_username }}"
  - "automation_user"
  - "fourth_estate_admin"

# DISA STIG Compliance
enable_disa_stig_compliance: true
stig_restricted_actions:
  - "DISABLE_AUDIT"
  - "DELETE_BACKUP"
  - "MODIFY_SECURITY_POLICY"
  - "DISABLE_LOGGING"

# SIEM Integration
audit_siem_integration_enabled: true
siem_endpoint: "{{ vault_siem_endpoint }}"
siem_api_token: "{{ vault_siem_api_token }}"

# Notification Settings
audit_notify_on_completion: true
audit_notification_email: "{{ vault_security_team_email }}"

# Export Settings
audit_export_zip: "{{ ise_artifacts_dir }}/ise_config_audit_{{ ansible_date_time.epoch }}.zip"

# Compliance Frameworks
compliance_frameworks:
  - "dod_stig"
  - "nist_800_53"
  - "nist_800_171"
  - "fisma_moderate"

# Logging
audit_log_level: "INFO"
audit_log_to_syslog: true
audit_syslog_server: "{{ vault_syslog_server }}"

# Retention
audit_retention_days: 90
audit_archive_old_reports: true

# Change Detection
audit_detect_unauthorized_changes: true
audit_alert_on_violations: true

# Reporting Format
audit_report_formats:
  - "json"
  - "csv"
  - "html"

# Email Configuration
smtp_host: "{{ vault_smtp_host | default('localhost') }}"
smtp_port: 25
