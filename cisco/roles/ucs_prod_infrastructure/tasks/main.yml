---
# tasks file for ucs_prod_infrastructure
# Cisco UCS Production Infrastructure Deployment for Fourth Estate
# Supports DoD STIG and NIST 800-53 compliance requirements

- name: Include prerequisites validation tasks
  ansible.builtin.include_tasks: prerequisites.yml
  tags:
    - always
    - prerequisites
    - validation

- name: Include UCS Manager initial configuration
  ansible.builtin.include_tasks: ucsm_initial_config.yml
  when: ucs_enable_ucsm_config | bool
  tags:
    - infrastructure
    - ucsm
    - initial_config

- name: Include organization and sub-organization setup
  ansible.builtin.include_tasks: organizations.yml
  when: ucs_enable_org_setup | bool
  tags:
    - infrastructure
    - organizations
    - hierarchy

- name: Include service profile template configuration
  ansible.builtin.include_tasks: service_profiles.yml
  when: ucs_enable_service_profiles | bool
  tags:
    - infrastructure
    - service_profiles
    - templates

- name: Include vNIC and vHBA template configuration
  ansible.builtin.include_tasks: vnic_vhba_templates.yml
  when: ucs_enable_vnic_vhba | bool
  tags:
    - infrastructure
    - networking
    - storage

- name: Include server pool configuration
  ansible.builtin.include_tasks: server_pools.yml
  when: ucs_enable_server_pools | bool
  tags:
    - infrastructure
    - servers
    - pools

- name: Include UUID and MAC address pool configuration
  ansible.builtin.include_tasks: uuid_mac_pools.yml
  when: ucs_enable_address_pools | bool
  tags:
    - infrastructure
    - pools
    - addressing

- name: Include firmware management tasks
  ansible.builtin.include_tasks: firmware_management.yml
  when: ucs_enable_firmware_mgmt | bool
  tags:
    - infrastructure
    - firmware
    - updates

- name: Include chassis and FEX discovery
  ansible.builtin.include_tasks: chassis_discovery.yml
  when: ucs_enable_chassis_discovery | bool
  tags:
    - infrastructure
    - chassis
    - discovery

- name: Include blade and rack server configuration
  ansible.builtin.include_tasks: server_configuration.yml
  when: ucs_enable_server_config | bool
  tags:
    - infrastructure
    - servers
    - configuration

- name: Include high availability configuration
  ansible.builtin.include_tasks: high_availability.yml
  when: ucs_enable_ha | bool
  tags:
    - infrastructure
    - ha
    - clustering

- name: Include verification and validation tasks
  ansible.builtin.include_tasks: validation.yml
  tags:
    - validation
    - verification
    - compliance
