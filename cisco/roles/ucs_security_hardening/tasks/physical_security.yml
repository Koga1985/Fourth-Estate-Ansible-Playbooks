---
# Physical and Environmental Protection (PE) - NIST 800-53 PE Family

- name: PE-2 - Document physical access controls
  ansible.builtin.copy:
    dest: "{{ ucs_artifacts_dir }}/physical_security.txt"
    mode: '0640'
    content: |
      Physical Security Controls for {{ fourth_estate_org_name }}
      ========================================================

      PE-2: Physical Access Authorization
      - Data center access requires badge authentication
      - Two-person integrity for critical areas
      - Access logs maintained and reviewed

      PE-3: Physical Access Control
      - Physical access control systems installed
      - Visitor access requires escort
      - Entry/exit points monitored 24/7

      PE-6: Monitoring Physical Access
      - CCTV surveillance of data center
      - Access logs retained for {{ pe_access_log_retention_days }} days
      - Real-time alerting for unauthorized access attempts

      PE-8: Visitor Access Records
      - All visitors logged and badged
      - Visitor access requires authorization
      - Visitor logs retained for audit

      PE-13: Fire Protection
      - Fire suppression systems installed
      - Regular fire safety inspections
      - Emergency procedures documented

      PE-14: Temperature and Humidity Controls
      - HVAC systems maintain optimal conditions
      - Temperature: {{ pe_temperature_range }}
      - Humidity: {{ pe_humidity_range }}
      - Environmental monitoring and alerting

      PE-15: Water Damage Protection
      - Water detection systems installed
      - Regular leak inspections
      - Emergency shutoff procedures

      PE-16: Delivery and Removal
      - Equipment delivery requires authorization
      - Asset removal tracked and approved
      - Inventory verification on delivery/removal
  delegate_to: localhost

- name: Configure chassis physical security settings
  ansible.builtin.debug:
    msg: "Physical security is enforced through data center controls"

- name: Record physical security compliance
  ansible.builtin.copy:
    dest: "{{ ucs_artifacts_dir }}/physical_security.json"
    mode: '0640'
    content: |
      {
        "nist_controls": ["PE-2", "PE-3", "PE-6", "PE-8", "PE-13", "PE-14", "PE-15", "PE-16"],
        "physical_access_controls": true,
        "monitoring_24x7": true,
        "environmental_controls": true,
        "access_log_retention_days": {{ pe_access_log_retention_days }},
        "documented_at": "{{ ansible_date_time.iso8601 }}"
      }
  delegate_to: localhost
