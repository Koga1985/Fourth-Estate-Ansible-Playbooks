---
# tasks file for ucs_security_hardening
# DoD STIG and NIST 800-53 Security Hardening for Cisco UCS

- name: Include STIG Category I (High) findings remediation
  ansible.builtin.include_tasks: stig_cat1.yml
  when: stig_cat1_enabled | bool
  tags:
    - security
    - stig
    - cat1
    - high

- name: Include STIG Category II (Medium) findings remediation
  ansible.builtin.include_tasks: stig_cat2.yml
  when: stig_cat2_enabled | bool
  tags:
    - security
    - stig
    - cat2
    - medium

- name: Include STIG Category III (Low) findings remediation
  ansible.builtin.include_tasks: stig_cat3.yml
  when: stig_cat3_enabled | bool
  tags:
    - security
    - stig
    - cat3
    - low

- name: Include access control hardening
  ansible.builtin.include_tasks: access_control.yml
  when: ac_enforce_rbac | bool
  tags:
    - security
    - access_control
    - nist_ac

- name: Include authentication hardening
  ansible.builtin.include_tasks: authentication.yml
  when: ia_enable_strong_auth | bool
  tags:
    - security
    - authentication
    - nist_ia

- name: Include audit and logging configuration
  ansible.builtin.include_tasks: audit_logging.yml
  when: au_enable_comprehensive_logging | bool
  tags:
    - security
    - audit
    - logging
    - nist_au

- name: Include cryptographic controls
  ansible.builtin.include_tasks: cryptography.yml
  when: sc_enforce_strong_crypto | bool
  tags:
    - security
    - cryptography
    - nist_sc

- name: Include network security controls
  ansible.builtin.include_tasks: network_security.yml
  when: sc_restrict_network_access | bool
  tags:
    - security
    - network
    - nist_sc

- name: Include configuration management controls
  ansible.builtin.include_tasks: config_management.yml
  when: cm_baseline_config | bool
  tags:
    - security
    - config_management
    - nist_cm

- name: Include system integrity controls
  ansible.builtin.include_tasks: system_integrity.yml
  when: si_enable_integrity_checks | bool
  tags:
    - security
    - integrity
    - nist_si

- name: Include physical security controls
  ansible.builtin.include_tasks: physical_security.yml
  when: pe_enable_physical_controls | bool
  tags:
    - security
    - physical
    - nist_pe

- name: Include DoD banner configuration
  ansible.builtin.include_tasks: dod_banner.yml
  when: dod_banner_enabled | bool
  tags:
    - security
    - banner
    - compliance

- name: Include compliance verification
  ansible.builtin.include_tasks: compliance_verification.yml
  tags:
    - security
    - compliance
    - verification
