---
- name: Ensure artifacts dir
  ansible.builtin.file:
    path: "{{ artifacts_dir }}"
    state: directory

- name: Generate low/zero-hit & shadowed-rules report (placeholder)
  ansible.builtin.shell: |
    set -euo pipefail
    echo "policy_set,rule_name,hits,shadowed_by" > "{{ artifacts_dir }}/policy_hitcount_shadow.csv"
    echo "{{ scan_policy_set }},ExampleRule,0,PriorBroaderRule" >> "{{ artifacts_dir }}/policy_hitcount_shadow.csv"
  args:
    executable: /bin/bash
  changed_when: false
