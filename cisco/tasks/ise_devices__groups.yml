
---
- name: ise_devices__groups â€” device groups (NDG)
  hosts: localhost
  connection: local
  gather_facts: false
  collections:
    - cisco.ise
    - community.general
  vars:
    artifacts_dir: "{ artifacts_dir | default('/tmp/ise-artifacts') }"
    apply_changes: "{ apply_changes | default(false) }"

  vars:
    ndg_tree: []
  tasks:
    - name: Ensure NDGs
      when: apply_changes | bool
      loop: "{{ ndg_tree }}"
      loop_control:
        label: "{{ item.name }}"
      cisco.ise.network_device_group:
        state: present
        data:
          name: "{{ item.name }}"
          description: "{{ item.description | default('') }}"
