---
# Dragos Asset Inventory Model - Fourth Estate OT/ICS

# Dragos Platform Connection
dragos_base_url: "https://tenant.dragos.com"
dragos_token: "{{ lookup('env','DRAGOS_TOKEN') }}"
dragos_verify_ssl: true
page_size: 500
artifacts_dir: "/tmp/dragos-artifacts"
dry_run: true

# Asset Operation Mode
asset_operation: "all"  # Options: discover, classify, enrich, zones, criticality, relationships, communications, protocols, all

# Asset Discovery
trigger_discovery_scan: false
discovery_scan_type: "comprehensive"  # Options: quick, standard, comprehensive
discovery_network_ranges: []
include_passive_discovery: true
include_active_discovery: false
deep_asset_inspection: true
wait_for_discovery: true
discovery_max_retries: 120
discovery_check_interval: 30

# Asset Classification
custom_classifications: []

# Asset Enrichment
default_custom_attributes: {}
add_business_context: true
add_compliance_tags: true
add_lifecycle_info: true

# Network Zones
network_zones:
  - "Level 0 - Physical Process"
  - "Level 1 - Basic Control"
  - "Level 2 - Supervisory Control"
  - "Level 3 - Site Operations"
  - "Level 4 - Enterprise Network"
  - "DMZ"
apply_zone_policies: false
zone_assignment_rules:
  PLC: "Level 1 - Basic Control"
  HMI: "Level 2 - Supervisory Control"
  "Engineering Station": "Level 2 - Supervisory Control"
  "SCADA Server": "Level 2 - Supervisory Control"
  Historian: "Level 3 - Site Operations"
  "Safety System": "Level 0 - Physical Process"
  RTU: "Level 1 - Basic Control"
  "IoT Device": "Level 1 - Basic Control"
purdue_level_mapping:
  PLC: "L1"
  HMI: "L2"
  "Engineering Station": "L2"
  "SCADA Server": "L2"
  Historian: "L3"
  "Safety System": "L0"
  RTU: "L1"
  "IoT Device": "L1"
zone_policies: {}

# Asset Criticality
enable_enhanced_monitoring: true

# Asset Relationships
relationship_timerange: "7d"
min_communication_count: 10

# Asset Communications
communication_timerange: "7d"

# Protocol Detection
protocol_timerange: "7d"

# Asset Tagging
tags_desired: []

# CMDB Integration
cmdb: {}  # Example: { url: "https://cmdb.example.com", token: "...", sync_enabled: true }

# Delta Export
delta_since_iso: ""  # ISO 8601 timestamp

# Notifications
notification_webhook_url: ""
