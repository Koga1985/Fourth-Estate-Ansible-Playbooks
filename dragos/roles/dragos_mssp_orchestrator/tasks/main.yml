---

- name: Ensure artifacts directory exists
  ansible.builtin.file:
    path: "{{ artifacts_dir }}"
    state: directory
    mode: "0755"

- name: Validate inputs
  ansible.builtin.assert:
    that:
      - tenants | length > 0
      - action_task | length > 0
    fail_msg: "You must supply tenants and action_task."

- name: Iterate tenants and include the action task
  ansible.builtin.include_tasks: include_action.yml
  loop: "{ tenants }"
  loop_control: { loop_var: tenant }
