---
# Dragos Sensor Operations - Fourth Estate OT/ICS Security

# Dragos Platform Connection
dragos_base_url: "https://tenant.dragos.com"
dragos_token: "{{ lookup('env','DRAGOS_TOKEN') }}"
dragos_verify_ssl: true
artifacts_dir: "/tmp/dragos-artifacts"
page_size: 500
dry_run: true

# Sensor Operation Mode
sensor_operation: "inventory"  # Options: deploy, configure, health, monitor, update, optimize, backup, inventory

# Sensor Inventory
sensors: []  # Example: [{ name: "sensor-1", id: "abc123", site: "Plant1", mgmt_ip: "10.1.1.10", mgmt_netmask: "255.255.255.0", mgmt_gateway: "10.1.1.1" }]

# Network Configuration
configure_networking: false
dns_servers:
  - "10.0.0.10"
  - "10.0.0.11"
ntp_servers:
  - "time.nist.gov"
  - "time.google.com"

# Monitoring Interfaces
monitor_interfaces: []  # Example: [{ interface: "eth1", zone: "OT-Zone1", vlan_id: 100, mtu: 9000 }]
default_pcap_filter: ""  # BPF filter for packet capture

# Packet Capture Settings
snapshot_length: 65535
capture_buffer_size: 524288000  # 500 MB
packet_buffer_size: 4096
ring_buffer_size: 8192
disable_offload: true

# Industrial Protocol Parsers
ot_protocols:
  - modbus
  - dnp3
  - iec61850
  - bacnet
  - profinet
  - ethernetip
  - opcua
  - s7comm
  - cip
deep_protocol_inspection: true

# Traffic Sampling
enable_sampling: false
sampling_rate: 1  # 1 in N packets

# Flow Export
export_flows: true
flow_timeout: 60
active_flow_timeout: 300

# Storage Configuration
configure_storage: false
pcap_retention_days: 30
pcap_max_storage_gb: 500
pcap_compression: true
pcap_rotation_policy: "size"  # Options: size, time
metadata_retention_days: 90
metadata_max_storage_gb: 100
disk_threshold_percent: 85
cleanup_priority: ["pcap", "logs", "metadata"]
storage_warning_threshold: 80
storage_critical_threshold: 90
storage_alert_frequency: "daily"

# Performance Tuning
performance_tuning: false
capture_cpu_cores: "0-3"
analysis_cpu_cores: "4-7"
numa_aware_processing: true
packet_buffer_mb: 2048
flow_cache_mb: 1024
asset_cache_mb: 512
protocol_cache_mb: 512
capture_threads: 4
worker_threads: 8
analysis_threads: 4
kernel_bypass_enabled: false
kernel_bypass_method: "af_packet"  # Options: af_packet, pf_ring, dpdk
tcp_flow_timeout: 3600
udp_flow_timeout: 300
icmp_flow_timeout: 60
ot_protocol_timeout: 7200

# High Availability
enable_ha: false
ha_heartbeat_interval: 5
ha_failover_timeout: 30
state_sync_interval: 10
auto_failback: false
health_check_interval: 10
failure_threshold: 3

# Sensor Updates
sensor_update_version: ""
update_schedule: "2025-02-01T02:00:00Z"
maintenance_window: 3600  # seconds
backup_before_update: true
auto_rollback: true
wait_for_completion: true
update_max_retries: 60
update_check_interval: 30

# Sensor Health Monitoring
packet_drop_threshold: 5.0  # percent

# Sensor Backup
backup_description: "Scheduled configuration backup"
backup_include_pcap: false
backup_include_logs: true
wait_for_backup: true
download_backups: true
cleanup_old_backups: true
backup_retention_days: 90

# Alerting
alert_webhook_url: ""
notification_webhook_url: ""
