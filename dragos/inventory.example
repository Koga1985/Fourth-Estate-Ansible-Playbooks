# Dragos Platform Inventory Example
# Copy this file to your inventory directory and customize

# --- Dragos Platform Servers ---
[dragos_platform]
dragos-primary ansible_host=192.168.100.10
dragos-secondary ansible_host=192.168.100.11

# --- Dragos Sensors ---
[dragos_sensors]
dragos-sensor-01 ansible_host=192.168.100.20 sensor_zone=zone1
dragos-sensor-02 ansible_host=192.168.100.21 sensor_zone=zone2
dragos-sensor-03 ansible_host=192.168.100.22 sensor_zone=zone3

# --- All Dragos Components ---
[dragos:children]
dragos_platform
dragos_sensors

# --- Ansible Control Node (for API calls) ---
[localhost]
localhost ansible_connection=local ansible_python_interpreter=/usr/bin/python3

# --- Common Variables ---
[dragos:vars]
ansible_user=ansible
ansible_become=true
ansible_python_interpreter=/usr/bin/python3

# Dragos Platform API Configuration
dragos_api_url=https://dragos-primary.example.com/api
dragos_api_token={{ vault_dragos_api_token }}
dragos_api_verify_ssl=true

# --- Sensor Configuration ---
[dragos_sensors:vars]
dragos_sensor_mode=passive
dragos_sensor_interface=eth1
dragos_sensor_span_port=true

# PCAP storage
dragos_pcap_retention_days=30
dragos_pcap_storage_path=/var/lib/dragos/pcap

# --- Integration Configuration ---
[dragos:vars]
# SIEM Integration
dragos_siem_enabled=true
dragos_siem_type=splunk
dragos_siem_host=splunk.example.com
dragos_siem_port=8088
dragos_siem_token={{ vault_dragos_siem_token }}

# ServiceNow Integration
dragos_servicenow_enabled=false
dragos_servicenow_instance=example.service-now.com
dragos_servicenow_user={{ vault_servicenow_user }}
dragos_servicenow_password={{ vault_servicenow_password }}

# Jira Integration
dragos_jira_enabled=false
dragos_jira_url=https://jira.example.com
dragos_jira_project=OT-SEC
dragos_jira_token={{ vault_jira_token }}

# --- Alert Configuration ---
[dragos:vars]
dragos_alert_severity_threshold=medium
dragos_alert_email_enabled=true
dragos_alert_email_recipients=["ot-security@example.com", "soc@example.com"]

# --- Governance & Compliance ---
[dragos:vars]
dragos_governance_framework=NIST-CSF
dragos_compliance_reporting_enabled=true
dragos_compliance_schedule="0 6 * * 1"

# --- Network Segmentation ---
[dragos:vars]
dragos_segmentation_zones:
  - name: zone1
    description: "Level 3 - Site Operations"
    vlan: 100
  - name: zone2
    description: "Level 2 - Control Systems"
    vlan: 200
  - name: zone3
    description: "Level 1 - Basic Control"
    vlan: 300

# --- Vulnerability Management ---
[dragos:vars]
dragos_vuln_scan_enabled=true
dragos_vuln_scan_schedule="0 2 * * 0"
dragos_vuln_severity_threshold=high
