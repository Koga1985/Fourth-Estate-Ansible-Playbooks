---
# Handlers for Kubernetes cluster installation

- name: Restart containerd
  ansible.builtin.systemd:
    name: containerd
    state: restarted
    daemon_reload: true

- name: Restart kubelet
  ansible.builtin.systemd:
    name: kubelet
    state: restarted
    daemon_reload: true

- name: Reload systemd
  ansible.builtin.systemd:
    daemon_reload: true

- name: Restart kube-apiserver
  ansible.builtin.command: kubectl -n kube-system delete pod -l component=kube-apiserver
  changed_when: true
  ignore_errors: true

- name: Restart kube-controller-manager
  ansible.builtin.command: kubectl -n kube-system delete pod -l component=kube-controller-manager
  changed_when: true
  ignore_errors: true

- name: Restart kube-scheduler
  ansible.builtin.command: kubectl -n kube-system delete pod -l component=kube-scheduler
  changed_when: true
  ignore_errors: true
