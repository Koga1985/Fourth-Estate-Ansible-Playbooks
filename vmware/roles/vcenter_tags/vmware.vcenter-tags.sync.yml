---
- hosts: localhost
  gather_facts: false
  roles:
    - role: vcenter_tags
      vars:
        vcenter_hostname: "vcenter.example.local"
        vcenter_username: "{{ lookup('env','VCENTER_USERNAME') }}"
        vcenter_password: "{{ lookup('env','VCENTER_PASSWORD') }}"
        vcenter_validate_certs: false
        tag_categories:
          - { name: "environment", description: "Env", cardinality: MULTIPLE, associable_types: ["VirtualMachine","Datastore"] }
          - { name: "app_tier", description: "Tier", cardinality: SINGLE, associable_types: ["VirtualMachine"] }
        tags:
          - { category: "environment", tags: ["prod","dev","qa"] }
          - { category: "app_tier", tags: ["web","app","db"] }
        tag_bindings:
          - object_type: "VirtualMachine"
            object_name: "app01"
            assignments:
              - { category: "environment", tags: ["prod"] }
              - { category: "app_tier", tags: ["app"] }
            enforce_exclusive: true
