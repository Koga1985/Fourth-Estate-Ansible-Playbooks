---
- hosts: localhost
  gather_facts: false
  roles:
    - role: vcenter_alarms_policies
      vars:
        vcenter_hostname: "vcenter.example.local"
        vcenter_username: "{{ lookup('env','VCENTER_USERNAME') }}"
        vcenter_password: "{{ lookup('env','VCENTER_PASSWORD') }}"
        vcenter_validate_certs: false
        alarms:
          - name: "Datastore usage high"
            target_type: "Datastore"
            expression: { preset: "datastore_usage_high" }
            actions:
              - { type: email, to: "ops@example.local" }
              - { type: status }
          - name: "Host connection and power state"
            target_type: "HostSystem"
            expression: { preset: "host_connection_and_power_state" }
            actions:
              - { type: email, to: "noc@example.local" }
