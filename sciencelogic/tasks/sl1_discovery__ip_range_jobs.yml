
---
# create/execute discovery sessions for IP ranges/CIDRs with given creds.
- name: Ensure artifacts dir
  ansible.builtin.file:
    path: "{{ artifacts_dir | default('/tmp/sl1-artifacts') }}"
    state: directory
    mode: "0755"

- name: Validate discovery inputs
  ansible.builtin.assert:
    that: [ ranges is defined, creds is defined ]
    fail_msg: "ranges and creds are required"
- name: Save discovery plan (placeholder)
  ansible.builtin.copy:
    dest: "{{ artifacts_dir }}/discovery_ip_ranges.json"
    mode: "0644"
    content: "{{ {'ranges': ranges, 'creds': creds, 'schedule': schedule | default('now')} | to_nice_json }}"
