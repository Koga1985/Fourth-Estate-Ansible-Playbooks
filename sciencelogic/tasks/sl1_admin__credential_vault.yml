
---
# create/update credentials; test against sample IPs.
- name: Ensure artifacts dir
  ansible.builtin.file:
    path: "{{ artifacts_dir | default('/tmp/sl1-artifacts') }}"
    state: directory
    mode: "0755"

- name: Validate credential inputs
  ansible.builtin.assert:
    that: [ creds is defined ]
    fail_msg: "Provide creds:[] list"
- name: Save desired credentials (placeholder)
  ansible.builtin.copy:
    dest: "{{ artifacts_dir }}/credentials_desired.json"
    mode: "0644"
    content: "{{ creds | to_nice_json }}"
- name: Test credential samples (placeholder)
  when: test_targets is defined
  ansible.builtin.copy:
    dest: "{{ artifacts_dir }}/credential_tests.txt"
    mode: "0644"
    content: |
      Will test {{ test_targets | length }} targets with provided credential sets (implement via SL1 API). 
