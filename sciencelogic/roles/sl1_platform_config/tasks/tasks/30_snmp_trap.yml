---
- name: Configure SNMP trap receiver
  ansible.builtin.uri:
    url: "{{ sl1.url }}/api/system/snmp/trap"
    method: PUT
    body:
      enabled: "{{ sl1_snmp_trap.enabled }}"
      port: "{{ sl1_snmp_trap.port }}"
      community_strings: "{{ sl1_snmp_trap.community_strings }}"
      allowed_sources: "{{ sl1_snmp_trap.allowed_sources }}"
      trap_processing: "{{ sl1_snmp_trap.trap_processing }}"
      auto_clear_events: "{{ sl1_snmp_trap.auto_clear_events }}"
    body_format: json
    headers:
      Content-Type: "application/json"
      X-EM7-API-Username: "{{ sl1.api_user }}"
      X-EM7-API-Password: "{{ sl1.api_password }}"
    validate_certs: "{{ sl1.verify_ssl }}"
    status_code: [200, 201]
  when: not dry_run
