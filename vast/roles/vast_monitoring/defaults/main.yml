---
# defaults file for vast_monitoring
# VAST Data Storage Monitoring and Alerting for Fourth Estate

vast_mgmt_host: "{{ vault_vast_mgmt_host }}"
vast_mgmt_port: 443
vast_mgmt_user: "{{ vault_vast_mgmt_user }}"
vast_mgmt_password: "{{ vault_vast_mgmt_password }}"
vast_api_version: "v1"
vast_verify_ssl: true

# SNMP Configuration (DoD STIG requirement for monitoring)
vast_enable_snmp: true
vast_snmp_version: "3"  # Only SNMPv3 for DoD compliance
vast_snmp_community: "{{ vault_vast_snmp_community }}"
vast_snmp_user: "{{ vault_vast_snmp_user | default('vastmonitor') }}"
vast_snmp_auth_protocol: "SHA256"  # SHA256 for FIPS compliance
vast_snmp_auth_password: "{{ vault_vast_snmp_auth_password | default('') }}"
vast_snmp_priv_protocol: "AES256"  # AES256 for FIPS compliance
vast_snmp_priv_password: "{{ vault_vast_snmp_priv_password | default('') }}"
vast_snmp_trap_destinations:
  - host: "{{ vault_snmp_trap_server_primary | default('') }}"
    port: 162
    community: "{{ vault_vast_snmp_trap_community | default('') }}"
  - host: "{{ vault_snmp_trap_server_secondary | default('') }}"
    port: 162
    community: "{{ vault_vast_snmp_trap_community | default('') }}"

# Syslog Configuration (NIST 800-53 AU-4, AU-9)
vast_enable_syslog: true
vast_syslog_servers:
  - host: "{{ vault_syslog_server_primary | default('') }}"
    port: 6514  # TLS syslog
    protocol: "tcp"
    use_tls: true
  - host: "{{ vault_syslog_server_secondary | default('') }}"
    port: 6514
    protocol: "tcp"
    use_tls: true
vast_syslog_facility: "local7"
vast_syslog_severity: "info"
vast_syslog_format: "rfc5424"

# Performance Monitoring
vast_enable_performance_monitoring: true
vast_performance_metrics:
  - "iops"
  - "read_iops"
  - "write_iops"
  - "throughput"
  - "read_throughput"
  - "write_throughput"
  - "latency"
  - "read_latency"
  - "write_latency"
  - "capacity"
  - "used_capacity"
  - "available_capacity"
  - "cpu_usage"
  - "memory_usage"
  - "network_throughput"
  - "data_reduction_ratio"
  - "compression_ratio"
  - "deduplication_ratio"
vast_metric_collection_interval: 60  # seconds

# Protocol-specific Monitoring
vast_monitor_nfs_metrics: true
vast_monitor_smb_metrics: true
vast_monitor_s3_metrics: true

# Health Checks
vast_health_check_enabled: true
vast_health_check_interval: 300  # 5 minutes
vast_health_check_components:
  - "cluster"
  - "nodes"
  - "drives"
  - "ssds"
  - "nvme"
  - "network"
  - "services"
  - "vipools"
  - "views"
  - "quotas"

# Capacity Monitoring and Forecasting
vast_capacity_monitoring_enabled: true
vast_capacity_check_interval: 3600  # 1 hour
vast_capacity_forecast_days: 90
vast_capacity_trending_enabled: true

# Performance Trending
vast_performance_trending_enabled: true
vast_performance_baseline_days: 30
vast_performance_anomaly_detection: true

# Alerting Configuration
vast_alert_email_enabled: true
vast_alert_email_recipients:
  - "storage-admins@fourthestate.local"
  - "noc@fourthestate.local"
vast_smtp_server: "{{ vault_smtp_server | default('') }}"
vast_smtp_port: 25
vast_smtp_from: "vast-alerts@fourthestate.local"

# Alert Thresholds
vast_alert_on_capacity_threshold: 80  # percentage
vast_alert_on_capacity_critical: 90  # percentage
vast_alert_on_performance_degradation: true
vast_alert_on_latency_threshold_ms: 10  # milliseconds
vast_alert_on_hardware_failure: true
vast_alert_on_security_events: true
vast_alert_on_node_failure: true
vast_alert_on_drive_failure: true
vast_alert_on_network_issues: true
vast_alert_on_replication_lag: true
vast_alert_on_snapshot_failures: true

# SNMP Traps
vast_send_snmp_traps: true
vast_snmp_trap_severity_level: "warning"  # info, warning, error, critical

# Integration with Monitoring Tools
vast_prometheus_enabled: false
vast_prometheus_port: 9090
vast_prometheus_retention_days: 30
vast_prometheus_scrape_interval: 60

vast_grafana_enabled: false
vast_grafana_url: "{{ vault_grafana_url | default('') }}"
vast_grafana_api_key: "{{ vault_grafana_api_key | default('') }}"
vast_grafana_dashboard_provisioning: true

vast_splunk_enabled: false
vast_splunk_hec_url: "{{ vault_splunk_hec_url | default('') }}"
vast_splunk_hec_token: "{{ vault_splunk_hec_token | default('') }}"
vast_splunk_index: "vast_storage"

# Monitoring Scripts
vast_monitoring_script_dir: "/opt/vast/monitoring"
vast_monitoring_log_dir: "/var/log/vast"

# Notification Settings
vast_notification_channels:
  - type: "email"
    enabled: true
  - type: "snmp"
    enabled: true
  - type: "syslog"
    enabled: true
  - type: "webhook"
    enabled: false
    url: "{{ vault_webhook_url | default('') }}"

# Quota Monitoring
vast_monitor_quota_usage: true
vast_quota_warning_threshold: 80
vast_quota_critical_threshold: 95

# Replication Monitoring
vast_monitor_replication: true
vast_replication_lag_warning_minutes: 30
vast_replication_lag_critical_minutes: 60

# Snapshot Monitoring
vast_monitor_snapshots: true
vast_snapshot_failure_alert: true
vast_snapshot_retention_compliance_check: true

# Node Health Monitoring
vast_node_cpu_threshold: 90
vast_node_memory_threshold: 90
vast_node_temperature_threshold: 75  # Celsius

# Drive Health Monitoring
vast_drive_smart_monitoring: true
vast_drive_wear_level_threshold: 80
vast_drive_read_errors_threshold: 10
vast_drive_write_errors_threshold: 10

# Network Performance Monitoring
vast_network_packet_loss_threshold: 1  # percentage
vast_network_bandwidth_utilization_threshold: 80  # percentage

# Data Reduction Monitoring
vast_monitor_data_reduction: true
vast_data_reduction_ratio_expected: 2.0  # 2:1

# Custom Dashboards
vast_create_custom_dashboards: true
vast_dashboard_refresh_interval: 60  # seconds
