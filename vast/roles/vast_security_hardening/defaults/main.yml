---
# defaults file for vast_security_hardening
# DoD STIG and NIST 800-53 Security Hardening Defaults

# VAST Management Connection
vast_mgmt_host: "{{ vault_vast_mgmt_host }}"
vast_mgmt_port: 443
vast_mgmt_user: "{{ vault_vast_mgmt_user }}"
vast_mgmt_password: "{{ vault_vast_mgmt_password }}"
vast_api_version: "v1"
vast_verify_ssl: true

# Access Control (NIST 800-53 AC family, STIG V-238197)
vast_enable_ldap: true
vast_ldap_server: "{{ vault_ldap_server | default('') }}"
vast_ldap_port: 636  # LDAPS for encryption
vast_ldap_use_ssl: true
vast_ldap_base_dn: "{{ vault_ldap_base_dn | default('') }}"
vast_enable_active_directory: true
vast_ad_domain: "{{ vault_ad_domain | default('') }}"
vast_require_kerberos: true

# Password Policy (NIST 800-63B, STIG V-238199)
vast_password_min_length: 15
vast_password_complexity_required: true
vast_password_max_age_days: 60
vast_password_history_count: 24
vast_account_lockout_threshold: 3
vast_account_lockout_duration_minutes: 15

# Session Management (STIG V-238201)
vast_session_timeout_minutes: 15
vast_max_concurrent_sessions: 3
vast_enable_session_audit: true

# Encryption Settings (NIST 800-52r2, STIG V-238203)
vast_enforce_encryption_at_rest: true
vast_enforce_encryption_in_transit: true
vast_fips_140_2_mode: true
vast_tls_min_version: "1.2"
vast_disable_weak_ciphers: true
vast_allowed_cipher_suites:
  - "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
  - "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"
  - "TLS_DHE_RSA_WITH_AES_256_GCM_SHA384"
  - "TLS_DHE_RSA_WITH_AES_128_GCM_SHA256"

# Audit and Logging (NIST 800-53 AU family, STIG V-238205)
vast_audit_all_access: true
vast_audit_admin_actions: true
vast_audit_failed_logins: true
vast_audit_config_changes: true
vast_audit_log_retention_days: 365
vast_audit_log_integrity_check: true
vast_send_logs_to_siem: true
vast_siem_server: "{{ vault_siem_server | default('') }}"

# Protocol Security (STIG V-238207)
vast_disable_smb1: true
vast_disable_smb2: false
vast_smb_signing_required: true
vast_smb_encryption_required: true
vast_nfs_require_secure_port: true
vast_nfs_kerberos_only: false
vast_disable_anonymous_access: true

# File System Security (STIG V-238209)
vast_enable_access_based_enumeration: true
vast_enforce_unix_permissions: true
vast_default_umask: "0027"
vast_disable_suid_sgid: false

# Network Security (STIG V-238211)
vast_enable_firewall: true
vast_allowed_management_networks:
  - "10.0.0.0/8"
  - "172.16.0.0/12"
  - "192.168.0.0/16"
vast_enable_intrusion_detection: false
vast_block_countries: []

# Vulnerability Management (STIG V-238213)
vast_auto_update_enabled: false  # Manual control for production
vast_security_scan_enabled: true
vast_vulnerability_scan_schedule: "weekly"

# Backup and Recovery Security (STIG V-238215)
vast_backup_encryption_required: true
vast_backup_integrity_check: true
vast_disaster_recovery_tested: false

# Compliance Reporting (STIG V-238217)
vast_generate_compliance_reports: true
vast_compliance_report_schedule: "monthly"
vast_compliance_frameworks:
  - "dod_stig"
  - "nist_800_53"
  - "nist_800_171"

# Multi-factor Authentication (NIST 800-63B)
vast_require_mfa: false
vast_mfa_methods:
  - "totp"
  - "hardware_token"

# Certificate Management (STIG V-238219)
vast_use_dod_pki_certificates: true
vast_certificate_validation_strict: true
vast_cert_expiry_warning_days: 30
