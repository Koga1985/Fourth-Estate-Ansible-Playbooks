---
# Production deployment playbook for VAST Data Storage
# This playbook performs full configuration, hardening, and monitoring setup
# Suitable for Fourth Estate production environments

- name: Deploy VAST Data Storage - Production Ready
  hosts: localhost
  connection: local
  gather_facts: true

  vars_files:
    - ../vars/production.yml
    - ../vars/vault.yml  # Encrypted with ansible-vault

  pre_tasks:
    - name: Display deployment information
      ansible.builtin.debug:
        msg:
          - "Deploying VAST Data Storage Configuration"
          - "Environment: Production"
          - "Target Cluster: {{ vast_mgmt_host }}"
          - "Compliance: DoD STIG, NIST 800-53"

  roles:
    - role: ../roles/vast_config
      tags: ['config', 'base']

    - role: ../roles/vast_security_hardening
      tags: ['security', 'hardening', 'stig']

    - role: ../roles/vast_monitoring
      tags: ['monitoring', 'alerting']

    - role: ../roles/vast_backup_dr
      tags: ['backup', 'dr']

  post_tasks:
    - name: Verify compliance status
      ansible.builtin.include_tasks: ../tasks/verify_compliance.yml
      tags: ['verification', 'compliance']

    - name: Display deployment summary
      ansible.builtin.debug:
        msg:
          - "VAST deployment completed successfully"
          - "Security hardening: Applied"
          - "Monitoring: Configured"
          - "Backup/DR: Enabled"
          - "Next steps: Review compliance report and configure application access"
