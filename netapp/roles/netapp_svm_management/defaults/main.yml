---
# defaults file for netapp_svm_management
# NetApp ONTAP Storage Virtual Machine Configuration
# Fourth Estate Production Environment

# Connection settings
netapp_svm_hostname: "{{ vault_netapp_cluster_hostname | default('netapp-cluster.example.com') }}"
netapp_svm_username: "{{ vault_netapp_cluster_username | default('admin') }}"
netapp_svm_password: "{{ vault_netapp_cluster_password }}"
netapp_svm_validate_certs: true

# SVM basic configuration
netapp_svm_name: "svm_prod"
netapp_svm_root_volume: "{{ netapp_svm_name }}_root"
netapp_svm_root_aggregate: "aggr1_netapp01_SAS"
netapp_svm_root_security_style: "unix"
netapp_svm_ipspace: "Default"
netapp_svm_subtype: "default"
netapp_svm_comment: "Production SVM for Fourth Estate Agency"
netapp_svm_language: "c.UTF-8"
netapp_svm_snapshot_policy: "default"

# Allowed protocols
netapp_svm_allowed_protocols:
  - nfs
  - cifs
  - iscsi
  - fcp

# SVM aggregate list (aggregates allowed for this SVM)
netapp_svm_aggr_list:
  - "aggr1_netapp01_SAS"
  - "aggr1_netapp02_SAS"

# Management LIF configuration
netapp_svm_create_mgmt_lif: true
netapp_svm_mgmt_lif_name: "{{ netapp_svm_name }}_mgmt"
netapp_svm_mgmt_lif_home_port: "e0c"
netapp_svm_mgmt_lif_home_node: "netapp-01"
netapp_svm_mgmt_lif_address: "10.0.100.10"
netapp_svm_mgmt_lif_netmask: "255.255.255.0"
netapp_svm_mgmt_lif_protocols:
  - none
netapp_svm_mgmt_lif_firewall_policy: "mgmt"
netapp_svm_mgmt_lif_auto_revert: true

# Data LIFs configuration
netapp_svm_create_data_lifs: true
netapp_svm_data_lifs:
  - name: "{{ netapp_svm_name }}_nfs_lif1"
    home_port: "e0c"
    home_node: "netapp-01"
    address: "10.0.100.11"
    netmask: "255.255.255.0"
    protocols:
      - nfs
    firewall_policy: "data"
    is_auto_revert: true
    failover_policy: "system-defined"
  - name: "{{ netapp_svm_name }}_cifs_lif1"
    home_port: "e0d"
    home_node: "netapp-02"
    address: "10.0.100.12"
    netmask: "255.255.255.0"
    protocols:
      - cifs
    firewall_policy: "data"
    is_auto_revert: true
    failover_policy: "system-defined"
  - name: "{{ netapp_svm_name }}_iscsi_lif1"
    home_port: "e0c"
    home_node: "netapp-01"
    address: "192.168.100.11"
    netmask: "255.255.255.0"
    protocols:
      - iscsi
    firewall_policy: "data"
    is_auto_revert: false
    failover_policy: "disabled"
  - name: "{{ netapp_svm_name }}_iscsi_lif2"
    home_port: "e0d"
    home_node: "netapp-02"
    address: "192.168.100.12"
    netmask: "255.255.255.0"
    protocols:
      - iscsi
    firewall_policy: "data"
    is_auto_revert: false
    failover_policy: "disabled"

# DNS configuration
netapp_svm_configure_dns: true
netapp_svm_dns_domains:
  - "agency.gov"
  - "internal.agency.gov"
netapp_svm_dns_nameservers:
  - "10.0.1.10"
  - "10.0.1.11"

# NFS configuration
netapp_svm_enable_nfs: true
netapp_svm_nfs_v3_enabled: enabled
netapp_svm_nfs_v4_enabled: enabled
netapp_svm_nfs_v41_enabled: enabled
netapp_svm_nfs_vstorage_state: disabled
netapp_svm_nfs_udp: disabled  # DISA STIG: Disable UDP for NFSv4

# Export policies
netapp_svm_create_export_policies: true
netapp_svm_export_policies:
  - name: "default"
  - name: "nfs_production"
  - name: "nfs_restricted"

# CIFS/SMB configuration
netapp_svm_enable_cifs: true
netapp_svm_cifs_server_name: "{{ netapp_svm_name | upper }}"
netapp_svm_cifs_domain: "AGENCY.GOV"
netapp_svm_cifs_admin_user: "{{ vault_netapp_cifs_admin_user }}"
netapp_svm_cifs_admin_password: "{{ vault_netapp_cifs_admin_password }}"
netapp_svm_cifs_ou: "OU=Storage,OU=Servers,DC=agency,DC=gov"
netapp_svm_cifs_workgroup: ""

# CIFS security settings (DISA STIG compliant)
netapp_svm_configure_cifs_security: true
netapp_svm_cifs_signing_required: "true"
netapp_svm_cifs_smb2_enabled: "true"
netapp_svm_cifs_smb3_enabled: "true"

# iSCSI configuration
netapp_svm_enable_iscsi: true

# FCP configuration
netapp_svm_enable_fcp: false

# NVMe configuration
netapp_svm_enable_nvme: false

# LDAP configuration
netapp_svm_configure_ldap: false
netapp_svm_ldap_client_name: "ldap_client_prod"
netapp_svm_ldap_servers:
  - "ldap1.agency.gov"
  - "ldap2.agency.gov"
netapp_svm_ldap_base_dn: "dc=agency,dc=gov"
netapp_svm_ldap_base_scope: "subtree"
netapp_svm_ldap_bind_dn: "cn=netapp-bind,ou=Service Accounts,dc=agency,dc=gov"
netapp_svm_ldap_bind_password: "{{ vault_netapp_ldap_bind_password }}"
netapp_svm_ldap_schema: "RFC-2307"
netapp_svm_ldap_use_start_tls: true
netapp_svm_ldap_session_security: "sign"  # DISA STIG: sign or seal

# Name service switch configuration
netapp_svm_configure_name_service: true
netapp_svm_name_service_switch:
  - database_type: "hosts"
    sources:
      - files
      - dns
  - database_type: "passwd"
    sources:
      - files
      - ldap
  - database_type: "group"
    sources:
      - files
      - ldap
  - database_type: "netgroup"
    sources:
      - files
      - ldap

# SVM routing configuration
netapp_svm_configure_routes: true
netapp_svm_routes:
  - destination: "0.0.0.0/0"
    gateway: "10.0.100.1"
    metric: 20

# SVM peer relationships for DR/replication
netapp_svm_create_peer_relationships: false
netapp_svm_peer_relationships: []
#  - peer_vserver: "svm_dr"
#    peer_cluster: "netapp-dr-cluster"
#    applications:
#      - snapmirror
#    dest_hostname: "netapp-dr-cluster.example.com"
#    dest_username: "admin"
#    dest_password: "{{ vault_netapp_dr_password }}"

# Vscan (anti-virus) configuration
netapp_svm_enable_vscan: false
netapp_svm_vscan_policy_name: "default_policy"
netapp_svm_vscan_scan_mandatory: true
netapp_svm_vscan_max_file_size: 2147483648  # 2GB
netapp_svm_vscan_file_ext_include:
  - "exe"
  - "dll"
  - "doc"
  - "docx"
  - "xls"
  - "xlsx"
  - "pdf"
netapp_svm_vscan_file_ext_exclude:
  - "tmp"
  - "log"

# Configuration verification
netapp_svm_verify_config: true

# Debug mode
netapp_svm_debug: false
