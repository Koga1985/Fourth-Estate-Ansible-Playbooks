---
# SentinelOne Agent Installation - Defaults
# Fourth Estate production-ready EDR deployment

# SentinelOne Configuration
s1_site_token: ""  # Site token - REQUIRED
s1_console_url: "https://usgoveast1.sentinelone.net"  # US GovCloud
s1_management_url: "{{ s1_console_url }}"

# Agent Version
s1_agent_version: "latest"
s1_agent_version_specific: ""  # Specify exact version if needed

# Installation Method
s1_install_method: "api"  # Options: api, local, url
s1_agent_download_path: "/tmp"
s1_local_installer_path: ""
s1_agent_download_url: ""

# API Configuration
s1_api_token: "{{ lookup('env', 'S1_API_TOKEN') }}"
s1_api_timeout: 300
s1_account_id: ""  # Optional: specific account
s1_site_id: ""     # Optional: specific site

# Agent Configuration
s1_group_name: "Default"
s1_tags: "Fourth-Estate,Managed-by-Ansible"
s1_agent_log_level: "info"  # Options: off, error, warning, info, debug, trace
s1_customer_id: ""

# Network Configuration
s1_proxy_enabled: false
s1_proxy_host: ""
s1_proxy_port: 8080
s1_proxy_username: ""
s1_proxy_password: ""

# Air-gapped Configuration
s1_air_gapped: false
s1_update_server: ""

# Service Configuration
s1_service_enable: true
s1_service_start: true
s1_restart_on_change: true

# Linux Specific
s1_linux_install_method: "rpm"  # Options: rpm, deb
s1_linux_package_name: "SentinelAgent"
s1_linux_service_name: "sentinelone"
s1_linux_install_path: "/opt/sentinelone"

# Windows Specific
s1_windows_install_method: "exe"  # Options: exe, msi
s1_windows_service_name: "SentinelAgent"
s1_windows_install_path: "C:\\Program Files\\SentinelOne"

# Container/Kubernetes
s1_container_enabled: false
s1_container_runtime: "docker"  # Options: docker, containerd, cri-o
s1_k8s_enabled: false
s1_k8s_namespace: "sentinelone"
s1_k8s_cluster_name: ""

# Security Configuration
s1_tamper_protection: true
s1_uninstall_protection: true
s1_self_protection: true
s1_remove_agent_on_uninstall: false

# Agent Features
s1_enable_network_quarantine: true
s1_enable_auto_mitigation: true
s1_enable_auto_remediation: true
s1_suspicious_activity_action: "detect"  # Options: detect, protect
s1_malicious_activity_action: "protect"  # Options: detect, protect

# Fourth Estate Specific
s1_fourth_estate_enabled: true
s1_source_protection: true
s1_journalist_protection: true
s1_secure_drop_monitoring: true
s1_enhanced_logging: true

# Deep Visibility
s1_enable_deep_visibility: true
s1_dv_retention_days: 90

# Monitoring
s1_enable_agent_monitoring: true
s1_health_check_interval: 3600  # 1 hour
s1_syslog_enabled: false
s1_syslog_server: ""
s1_syslog_port: 514

# Compliance
s1_stig_mode: true
s1_fips_mode: false
s1_audit_mode: false

# Update Configuration
s1_auto_update_enabled: true
s1_update_window_start: "02:00"
s1_update_window_end: "06:00"
