---
# CrowdStrike Falcon Sensor Installation - Defaults
# Fourth Estate production-ready EDR deployment

# Falcon Configuration
falcon_cid: ""  # Customer ID - REQUIRED
falcon_installation_token: ""  # Optional installation token
falcon_cloud: "us-1"  # Options: us-1, us-2, eu-1, us-gov-1

# Sensor Version
falcon_sensor_version: "latest"
falcon_sensor_version_decrement: "0"  # N-x versioning for stability

# Installation Method
falcon_install_method: "api"  # Options: api, local, repo
falcon_sensor_download_path: "/tmp"
falcon_local_installer_path: ""

# API Configuration
falcon_api_client_id: "{{ lookup('env', 'FALCON_CLIENT_ID') }}"
falcon_api_client_secret: "{{ lookup('env', 'FALCON_CLIENT_SECRET') }}"
falcon_api_base_url: "https://api.crowdstrike.com"
falcon_api_timeout: 300

# Sensor Configuration
falcon_sensor_backend: "auto"  # Options: auto, kernel, bpf
falcon_provisioning_wait: true
falcon_provisioning_timeout: 300
falcon_sensor_tags: "Fourth-Estate,Managed-by-Ansible"
falcon_sensor_apd: false  # Application Control/Protocol Detection
falcon_sensor_aph: false  # Application Protocol Handling
falcon_sensor_trace: "none"  # Trace level: none, err, warn, info, debug

# Network Configuration
falcon_proxy_enabled: false
falcon_proxy_host: ""
falcon_proxy_port: 8080
falcon_proxy_disable_ssl: false
falcon_billing: ""  # Billing tag

# Air-gapped Configuration
falcon_air_gapped: false
falcon_sensor_download_url: ""
falcon_sensor_remove_hash: false

# Service Configuration
falcon_service_enable: true
falcon_service_start: true
falcon_restart_on_change: true

# Linux Specific
falcon_linux_install_method: "rpm"  # Options: rpm, deb, tar
falcon_linux_package_name: "falcon-sensor"
falcon_linux_service_name: "falcon-sensor"
falcon_linux_uninstall_cleanup: true

# Windows Specific
falcon_windows_install_method: "exe"  # Options: exe, msi
falcon_windows_service_name: "CSFalconService"
falcon_windows_install_path: "C:\\Program Files\\CrowdStrike"
falcon_windows_maintenance_token: ""

# Container/Kubernetes
falcon_container_enabled: false
falcon_container_runtime: "docker"  # Options: docker, containerd, cri-o
falcon_k8s_enabled: false
falcon_k8s_namespace: "falcon-system"
falcon_k8s_cluster_name: ""

# Security Configuration
falcon_tamper_protection: true
falcon_remove_host_on_uninstall: false
falcon_sensor_grouping_tags: []

# Fourth Estate Specific
falcon_fourth_estate_enabled: true
falcon_source_protection: true
falcon_journalist_protection: true
falcon_secure_drop_monitoring: true
falcon_enhanced_logging: true

# FIPS Configuration
falcon_fips_enabled: false

# Update Configuration
falcon_sensor_update_policy: "enabled"
falcon_prevent_uninstall: true

# Monitoring
falcon_enable_sensor_monitoring: true
falcon_health_check_interval: 3600  # 1 hour

# Compliance
falcon_stig_mode: true
falcon_audit_mode: false
