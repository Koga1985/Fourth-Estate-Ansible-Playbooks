---
# GCP Basic Deployment Playbook
# Entry point for GCP automation
#
# Usage:
#   ansible-galaxy collection install -r requirements.yml
#   ansible-playbook -i inventory site.yml

- name: GCP Configuration
  hosts: localhost
  connection: local
  gather_facts: true

  vars:
    deploy_iam: true
    deploy_project: true

  tasks:
    - name: Phase 1 - Project Management
      ansible.builtin.include_role:
        name: gcp_project_management
      when: deploy_project | bool
      tags: ['project', 'phase1']

    - name: Phase 2 - IAM Configuration
      ansible.builtin.include_role:
        name: gcp_iam
      when: deploy_iam | bool
      tags: ['iam', 'phase2']

    - name: Display summary
      ansible.builtin.debug:
        msg:
          - "=== GCP Deployment Complete ==="
          - "Project: {{ gcp_project }}"
          - "Region: {{ gcp_region }}"
      tags: ['always']
