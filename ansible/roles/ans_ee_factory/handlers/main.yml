---
# Handlers for ans_ee_factory
- name: Scan container images
  ansible.builtin.command:
    cmd: "{{ ee_scanner }} image {{ item.image }}:{{ item.tag }}"
  loop: "{{ ee_definitions }}"
  loop_control:
    label: "{{ item.name }}"
  listen: "scan images"
  when: ee_scanning_enabled | bool
  changed_when: false

- name: Sign container images
  ansible.builtin.command:
    cmd: "cosign sign {{ item.image }}:{{ item.tag }}"
  loop: "{{ ee_definitions }}"
  loop_control:
    label: "{{ item.name }}"
  listen: "sign images"
  when: ee_signing_enabled | bool
