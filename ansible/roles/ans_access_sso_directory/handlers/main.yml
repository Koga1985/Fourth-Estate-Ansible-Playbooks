---
# Handlers for ans_access_sso_directory role
- name: Restart automation controller
  ansible.builtin.service:
    name: automation-controller
    state: restarted
  listen: "restart controller"

- name: Send access review notification
  ansible.builtin.mail:
    host: localhost
    port: 25
    to: "{{ access_review_recipients }}"
    subject: "Ansible Controller Access Review - {{ ansible_date_time.date }}"
    body: "Access review report has been generated. Please review the attached report."
    attach: "{{ artifacts_dir }}/access_review_{{ ansible_date_time.date }}.{{ access_review_output_format }}"
  listen: "send access review"
  when: access_review_recipients | length > 0
