---
# STIG Category III (Low Severity) Findings Remediation

- name: V-258130 - Display login banner
  ansible.builtin.lineinfile:
    path: "{{ splunk_home }}/etc/system/local/web.conf"
    line: "login_content = {{ dod_banner_text | default('Authorized Use Only') }}"
  when: dod_banner_enabled | bool
  notify: restart splunk
  tags:
    - CAT3
    - V-258130

- name: V-258132 - Remove sample applications
  ansible.builtin.file:
    path: "{{ splunk_home }}/etc/apps/{{ item }}"
    state: absent
  loop:
    - sample_app
    - legacy
  when: cm_remove_default_content | bool
  tags:
    - CAT3
    - V-258132

- name: V-258134 - Disable usage data collection
  ansible.builtin.lineinfile:
    path: "{{ splunk_home }}/etc/system/local/server.conf"
    line: "sendAnonymizedUsage = false"
    insertafter: '^\[telemetry\]'
  notify: restart splunk
  tags:
    - CAT3
    - V-258134
