---
# Application Hardening

- name: Disable debug mode
  ansible.builtin.lineinfile:
    path: "{{ splunk_home }}/etc/system/local/web.conf"
    line: "enableWebDebug = false"
  when: app_disable_debug_mode | bool
  notify: restart splunk
  tags:
    - application
    - hardening

- name: Enable strict validation
  ansible.builtin.lineinfile:
    path: "{{ splunk_home }}/etc/system/local/web.conf"
    line: "x_frame_options_sameorigin = true"
  when: app_enable_strict_validation | bool
  notify: restart splunk
  tags:
    - application
    - security

- name: Remove sample data
  ansible.builtin.shell: |
    find {{ splunk_home }}/etc/apps -name "*sample*" -type d -exec rm -rf {} + 2>/dev/null || true
  when: app_remove_sample_data | bool
  changed_when: false
  tags:
    - application
    - cleanup
