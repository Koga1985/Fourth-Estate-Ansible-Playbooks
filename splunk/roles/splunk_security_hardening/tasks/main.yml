---
# tasks file for splunk_security_hardening
# DoD STIG and NIST 800-53 Security Hardening

- name: Include STIG Category I (High) findings remediation
  ansible.builtin.include_tasks: stig_cat1.yml
  when: stig_cat1_enabled | bool
  tags:
    - security
    - stig
    - cat1
    - high

- name: Include STIG Category II (Medium) findings remediation
  ansible.builtin.include_tasks: stig_cat2.yml
  when: stig_cat2_enabled | bool
  tags:
    - security
    - stig
    - cat2
    - medium

- name: Include STIG Category III (Low) findings remediation
  ansible.builtin.include_tasks: stig_cat3.yml
  when: stig_cat3_enabled | bool
  tags:
    - security
    - stig
    - cat3
    - low

- name: Include access control hardening tasks
  ansible.builtin.include_tasks: access_control.yml
  when: ac_enforce_least_privilege | bool
  tags:
    - security
    - access_control
    - nist_ac

- name: Include authentication hardening tasks
  ansible.builtin.include_tasks: authentication.yml
  when: ia_enforce_mfa | bool or ia_password_complexity_required | bool
  tags:
    - security
    - authentication
    - nist_ia

- name: Include audit and logging hardening tasks
  ansible.builtin.include_tasks: audit_logging.yml
  when: au_enable_comprehensive_logging | bool
  tags:
    - security
    - audit
    - logging
    - nist_au

- name: Include network security hardening tasks
  ansible.builtin.include_tasks: network_security.yml
  when: hardening_restrict_network_access | bool
  tags:
    - security
    - network
    - nist_sc

- name: Include cryptography hardening tasks
  ansible.builtin.include_tasks: cryptography.yml
  when: sc_enforce_fips_140_2 | bool
  tags:
    - security
    - cryptography
    - fips
    - nist_sc

- name: Include application hardening tasks
  ansible.builtin.include_tasks: application_hardening.yml
  when: app_enable_strict_validation | bool
  tags:
    - security
    - application
    - hardening

- name: Include file system hardening tasks
  ansible.builtin.include_tasks: filesystem_hardening.yml
  when: fs_strict_permissions | bool
  tags:
    - security
    - filesystem
    - permissions

- name: Include configuration management hardening tasks
  ansible.builtin.include_tasks: config_management.yml
  when: cm_disable_unnecessary_services | bool
  tags:
    - security
    - config_management
    - nist_cm

- name: Include integrity monitoring tasks
  ansible.builtin.include_tasks: integrity_monitoring.yml
  when: si_enable_integrity_checks | bool
  tags:
    - security
    - integrity
    - monitoring
    - nist_si

- name: Include compliance verification tasks
  ansible.builtin.include_tasks: compliance_verification.yml
  tags:
    - security
    - compliance
    - verification

- name: Include DoD banner configuration tasks
  ansible.builtin.include_tasks: dod_banner.yml
  when: dod_banner_enabled | bool
  tags:
    - security
    - banner
    - compliance
