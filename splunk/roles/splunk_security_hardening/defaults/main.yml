---
# defaults file for splunk_security_hardening
# DoD STIG and NIST 800-53 Security Hardening for Splunk Enterprise

# Splunk Installation
splunk_home: "/opt/splunk"
splunk_user: "splunk"
splunk_group: "splunk"
splunk_admin_password: "{{ vault_splunk_admin_password }}"

# STIG Compliance Settings
stig_cat1_enabled: true  # High severity findings
stig_cat2_enabled: true  # Medium severity findings
stig_cat3_enabled: true  # Low severity findings

# Access Control (AC) - NIST 800-53 AC family
ac_enforce_least_privilege: true
ac_session_timeout_minutes: 15
ac_max_failed_login_attempts: 3
ac_account_lockout_duration_minutes: 15
ac_disable_default_accounts: true
ac_remove_unnecessary_accounts: true

# Audit and Accountability (AU) - NIST 800-53 AU family
au_enable_comprehensive_logging: true
au_audit_admin_actions: true
au_audit_failed_access_attempts: true
au_audit_privileged_functions: true
au_log_retention_days: 365
au_protect_audit_logs: true
au_audit_log_immutable: true

# Identification and Authentication (IA) - NIST 800-53 IA family
ia_password_min_length: 15
ia_password_complexity_required: true
ia_password_max_age_days: 60
ia_password_history_count: 24
ia_enforce_mfa: true
ia_disable_anonymous_access: true
ia_session_lock_enabled: true

# System and Communications Protection (SC) - NIST 800-53 SC family
sc_enforce_fips_140_2: true
sc_tls_min_version: "1.2"
sc_disable_weak_ciphers: true
sc_disable_sslv3: true
sc_disable_tls_10: true
sc_disable_tls_11: true
sc_enable_perfect_forward_secrecy: true
sc_cipher_suite: "ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256"

# Configuration Management (CM) - NIST 800-53 CM family
cm_disable_unnecessary_services: true
cm_disable_sample_apps: true
cm_remove_default_content: true
cm_baseline_configuration_tracking: true
cm_config_change_detection: true

# System and Information Integrity (SI) - NIST 800-53 SI family
si_enable_integrity_checks: true
si_malware_protection: false  # External AV recommended
si_file_integrity_monitoring: true
si_error_handling_secure: true
si_input_validation: true

# Media Protection (MP) - NIST 800-53 MP family
mp_data_at_rest_encryption: true
mp_secure_data_disposal: true
mp_removable_media_disabled: true

# Physical and Environmental Protection (PE) - NIST 800-53 PE family
pe_physical_access_controls: true  # Organizational control

# Risk Assessment (RA) - NIST 800-53 RA family
ra_vulnerability_scanning_enabled: true
ra_vulnerability_scan_schedule: "weekly"

# System and Services Acquisition (SA) - NIST 800-53 SA family
sa_software_integrity_verification: true
sa_disable_software_updates: true  # Manual updates in production

# Security Assessment and Authorization (CA) - NIST 800-53 CA family
ca_continuous_monitoring: true
ca_security_assessment_schedule: "monthly"

# Maintenance (MA) - NIST 800-53 MA family
ma_maintenance_logging: true
ma_controlled_maintenance: true

# Incident Response (IR) - NIST 800-53 IR family
ir_incident_logging: true
ir_siem_integration: true
ir_siem_server: "{{ vault_siem_server | default('') }}"

# Hardening Specific Settings
hardening_disable_scripted_inputs: false
hardening_disable_http_event_collector: false
hardening_restrict_network_access: true
hardening_remove_search_artifacts: true
hardening_secure_kvstore: true
hardening_enable_token_authentication: true

# Banner and Notifications
dod_banner_enabled: true
dod_banner_text: |
  You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.
  By using this IS (which includes any device attached to this IS), you consent to the following conditions:
  - The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to,
    penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE),
    and counterintelligence (CI) investigations.

# Network Hardening
network_allowed_ips: "{{ splunk_allowed_management_networks | default(['10.0.0.0/8', '172.16.0.0/12', '192.168.0.0/16']) }}"
network_enable_rate_limiting: true
network_max_connections: 1000

# File System Hardening
fs_strict_permissions: true
fs_remove_world_readable: true
fs_remove_suid_sgid: true
fs_enable_file_integrity: true

# Application Hardening
app_disable_rest_api_logging: false
app_enable_strict_validation: true
app_disable_debug_mode: true
app_remove_sample_data: true

# Compliance Reporting
compliance_generate_reports: true
compliance_report_path: "{{ splunk_home }}/var/log/splunk/compliance"
compliance_frameworks:
  - "dod_stig"
  - "nist_800_53"
  - "nist_800_171"
  - "fisma_moderate"
  - "fisma_high"
