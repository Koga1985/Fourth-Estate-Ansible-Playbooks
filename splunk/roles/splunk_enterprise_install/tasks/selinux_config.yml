---
# SELinux configuration tasks
# STIG V-258076

- name: Set SELinux context for Splunk directories
  community.general.sefcontext:
    target: "{{ item }}"
    setype: bin_t
    state: present
  loop:
    - "{{ splunk_home }}/bin(/.*)?"
    - "{{ splunk_home }}/etc(/.*)?"
  when: splunk_selinux_enabled | bool
  tags:
    - selinux
    - security

- name: Apply SELinux context
  ansible.builtin.command: "restorecon -R {{ splunk_home }}"
  when: splunk_selinux_enabled | bool
  changed_when: false
  tags:
    - selinux
    - security
