---
# Deployment client configuration tasks

- name: Configure deployment client
  ansible.builtin.copy:
    dest: "{{ splunk_home }}/etc/system/local/deploymentclient.conf"
    content: |
      [deployment-client]
      disabled = false

      [target-broker:deploymentServer]
      targetUri = {{ splunk_deployment_server }}
      clientName = {{ splunk_deployment_client_name }}
    owner: "{{ splunk_user }}"
    group: "{{ splunk_group }}"
    mode: '0600'
  when: splunk_deployment_server != ''
  notify: restart splunk
  tags:
    - deployment
    - client
