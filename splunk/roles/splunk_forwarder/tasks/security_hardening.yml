---
# Forwarder security hardening

- name: Set strict file permissions
  ansible.builtin.file:
    path: "{{ splunk_forwarder_home }}"
    owner: "{{ splunk_forwarder_user }}"
    group: "{{ splunk_forwarder_group }}"
    mode: '0755'
    recurse: yes

- name: Disable management port
  ansible.builtin.lineinfile:
    path: "{{ splunk_forwarder_home }}/etc/system/local/server.conf"
    line: "disableDefaultPort = true"
    insertafter: '^\[httpServer\]'
    create: yes
