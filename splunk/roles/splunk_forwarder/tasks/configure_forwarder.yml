---
# Forwarder configuration tasks

- name: Configure FIPS mode
  ansible.builtin.lineinfile:
    path: "{{ splunk_forwarder_home }}/etc/system/local/server.conf"
    line: "fipsMode = strict"
    insertafter: '^\[fips\]'
    create: yes
  when: splunk_forwarder_fips_mode | bool

- name: Configure TLS settings
  ansible.builtin.blockinfile:
    path: "{{ splunk_forwarder_home }}/etc/system/local/server.conf"
    block: |
      [sslConfig]
      sslVersions = {{ splunk_forwarder_tls_min_version }}, tls1.3
      cipherSuite = {{ splunk_forwarder_cipher_suite }}
    create: yes
