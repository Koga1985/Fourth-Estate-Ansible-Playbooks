---
# Disaster recovery configuration

- name: Create DR documentation
  ansible.builtin.copy:
    dest: "{{ splunk_home }}/var/log/splunk/DR_PROCEDURES.md"
    content: |
      # Splunk Disaster Recovery Procedures

      ## Recovery Point Objective (RPO)
      - Configuration: 24 hours
      - Data: Real-time (via replication)

      ## Recovery Time Objective (RTO)
      - Target: 4 hours

      ## DR Site
      - Location: {{ dr_remote_site }}
      - Replication: {{ 'Enabled' if dr_replication_enabled else 'Disabled' }}

      ## Recovery Steps
      1. Verify DR site availability
      2. Restore latest backup
      3. Verify Splunk services
      4. Validate data integrity
      5. Update DNS/load balancers
      6. Test search functionality

      ## Testing Schedule
      - Frequency: {{ dr_test_schedule }}
      - Last Test: [TO BE UPDATED]
      - Next Test: [TO BE SCHEDULED]
    owner: "{{ splunk_user }}"
    mode: '0600'
