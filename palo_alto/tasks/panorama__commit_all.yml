---
# Inputs:
#   commit_description: "Automated commit via Ansible"
#   commit_device_groups: ["Prod","DMZ"]
#   serial: true
#   include_template: false
#   include_device_and_network: false

- name: Commit to Panorama
  paloaltonetworks.panos.panos_commit:
    description: "{{ commit_description | default('Automated commit via Ansible') }}"

- name: Push commit to device-groups
  when: (commit_device_groups | default([])) | length > 0
  paloaltonetworks.panos.panos_commit_push:
    device_group: "{{ item }}"
    serial: "{{ serial | default(true) | bool }}"
    include_template: "{{ include_template | default(false) | bool }}"
    include_device_and_network: "{{ include_device_and_network | default(false) | bool }}"
  loop: "{{ commit_device_groups }}"
  loop_control: { label: "{{ item }}" }
