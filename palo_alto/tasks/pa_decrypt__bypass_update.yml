---
# Inputs:
#   decrypt_bypass_category: "NoDecrypt-BYPASS"
#   bypass_urls:
#     - "login.microsoftonline.com"
#     - "*.bank.example"
#   description: "Regulatory/Privacy bypass list"
#   pa_use_panorama: false
#   device_group: null
#   vsys: "vsys1"

- name: Ensure custom URL category for BYPASS exists
  paloaltonetworks.panos.panos_custom_url_category:
    name: "{{ decrypt_bypass_category }}"
    description: "{{ description | default(omit) }}"
    type: "URL List"
    sites: "{{ bypass_urls | default([]) }}"
    device_group: "{{ device_group if pa_use_panorama | default(false) else omit }}"
    vsys: "{{ vsys | default('vsys1') if not (pa_use_panorama | default(false)) else omit }}"
    state: "present"

- name: Info
  ansible.builtin.debug:
    msg: "Updated custom URL category '{{ decrypt_bypass_category }}' with {{ (bypass_urls | default([])) | length }} entries."
