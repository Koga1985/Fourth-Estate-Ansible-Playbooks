---
- name: Create/Update Decryption Profiles
  paloaltonetworks.panos.panos_decryption_profile:
    name: "{{ item.name }}"
    ssl_forward_proxy: "{{ item.ssl_forward_proxy | default(false) }}"
    ssl_inbound_inspection: "{{ item.ssl_inbound_inspection | default(false) }}"
    forward_trust_certificate: "{{ item.forward_trust_cert | default(omit) }}"
    strip_alpn: "{{ item.strip_alpn | default(omit) }}"
    unsupported_version_action: "{{ item.unsupported_version_action | default(omit) }}"
    device_group: "{{ device_group if pa_use_panorama | bool else omit }}"
    vsys: "{{ vsys if not (pa_use_panorama | bool) else omit }}"
    state: "present"
  loop: "{{ decryption_profiles | default([]) }}"
  loop_control: { label: "{{ item.name }}" }
