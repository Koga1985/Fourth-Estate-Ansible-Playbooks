---
- name: Import Forward-Trust certificate (if enabled)
  when: forward_trust_cert.enabled | default(false) | bool
  paloaltonetworks.panos.panos_certificate:
    certificate_name: "{{ forward_trust_cert.name }}"
    certificate: "{{ forward_trust_cert.certificate_file }}"
    private_key: "{{ forward_trust_cert.private_key_file | default(omit) }}"
    passphrase: "{{ forward_trust_cert.passphrase | default(omit) }}"
    state: "present"
    device_group: "{{ device_group if pa_use_panorama | bool else omit }}"
    vsys: "{{ vsys if not (pa_use_panorama | bool) else omit }}"
    template: "{{ template | default(omit) if pa_use_panorama | bool else omit }}"
    template_stack: "{{ template_stack | default(omit) if pa_use_panorama | bool else omit }}"
- name: Import Forward-Untrust certificate (if enabled)
  when: forward_untrust_cert.enabled | default(false) | bool
  paloaltonetworks.panos.panos_certificate:
    certificate_name: "{{ forward_untrust_cert.name }}"
    certificate: "{{ forward_untrust_cert.certificate_file }}"
    private_key: "{{ forward_untrust_cert.private_key_file | default(omit) }}"
    passphrase: "{{ forward_untrust_cert.passphrase | default(omit) }}"
    state: "present"
    device_group: "{{ device_group if pa_use_panorama | bool else omit }}"
    vsys: "{{ vsys if not (pa_use_panorama | bool) else omit }}"
    template: "{{ template | default(omit) if pa_use_panorama | bool else omit }}"
    template_stack: "{{ template_stack | default(omit) if pa_use_panorama | bool else omit }}"
