---
- name: Configure Group Mapping
  paloaltonetworks.panos.panos_userid_group_mapping:
    name: "{{ item.name }}"
    server_profile: "{{ item.ldap_profile }}"
    base: "{{ item.base }}"
    user_object_class: "{{ item.user_object_class | default(omit) }}"
    group_object_class: "{{ item.group_object_class | default(omit) }}"
    group_include_list: "{{ item.group_include_list | default(omit) }}"
    device_group: "{{ device_group if pa_use_panorama | bool else omit }}"
    vsys: "{{ vsys if not (pa_use_panorama | bool) else omit }}"
    state: "present"
  loop: "{{ group_mappings | default([]) }}"
  loop_control: { label: "{{ item.name }}" }
