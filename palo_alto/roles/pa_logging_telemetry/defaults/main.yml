---
# Panorama/firewall awareness
pa_use_panorama: false
device_group: null     # for Panorama
vsys: "vsys1"          # for firewalls

# Artifacts and behavior
artifacts_dir: "/tmp/pan-artifacts"
commit_after_changes: true
commit_description: "Apply logging/telemetry via Ansible"

# SYSLOG profile(s)
pa_syslog_profiles: []
# - name: "SIEM"
#   servers:
#     - { name: "siem1", ip_address: "192.0.2.50", transport: "UDP", port: 514, format: "BSD" }
#   description: "Primary SIEM"

# HTTP profile(s) (for HTTP/Splunk/CEF webhooks)
pa_http_profiles: []
# - name: "Splunk-HEC"
#   servers:
#     - { name: "hec1", address: "splunk.example", http_port: 8088, https: true, uri_format: "/services/collector", http_method: "POST", tls_verify: false, http_headers: [ "Authorization: Splunk <token>" ] }
#   description: "Splunk HEC"

# Log Forwarding Profiles (attach to rules or zones later)
pa_log_forwarding_profiles: []
# - name: "Default-Forward"
#   descriptions: "Forward to SIEM + Panorama"
#   match_list:
#     - name: "threats"
#       log_type: "THREAT"
#       actions:
#         - type: "syslog"
#           syslog_profile: "SIEM"
#         - type: "panorama"

# Optional: bind this log profile to all security rules with these tags
pa_bind_log_profile:
  enabled: false
  profile_name: "Default-Forward"
  rule_tags: ["owner:secops"]

# Telemetry (device-level; run this role against firewalls when enabling telemetry locally)
telemetry:
  enabled: false
  applications: true
  threats: true
  url: true
  wildfire: true
  passive_dns: false

# Cortex Data Lake note: forwarding to CDL is typically controlled by "logging service" enablement
# inside log settings / profiles. Use a match_list action with type: panorama or http depending on design.

# Tech-support bundle (optional)
techsupport:
  enabled: true
  exclude_logs: false
  # Optional: SCP offload destination (requires device to reach target)
  scp:
    enabled: false
    server: "scp.example.com"
    username: "tsuser"
    password: "{{ scp_password | default(lookup('env','SCP_PASSWORD')) }}"  # Required if scp.enabled=true
    path: "/incoming/"
