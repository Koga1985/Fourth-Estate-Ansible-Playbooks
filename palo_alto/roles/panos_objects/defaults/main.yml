---
# defaults file for panos_objects
# Fourth Estate object catalog defaults

# PAN-OS provider connection details
panos_provider:
  ip_address: "{{ ansible_host }}"
  username: "{{ panos_username | default('admin') }}"
  password: "{{ panos_password }}"
  api_key: "{{ panos_api_key | default(omit) }}"

# Address objects (IP, netmask)
panos_address_objects:
  - name: "Corporate_Network"
    value: "10.0.0.0/8"
    type: "ip-netmask"
    description: "Corporate internal network"
    tags: ["Internal", "Corporate"]
  - name: "DMZ_Network"
    value: "172.16.0.0/16"
    type: "ip-netmask"
    description: "DMZ network"
    tags: ["DMZ"]
  - name: "Management_Network"
    value: "192.168.1.0/24"
    type: "ip-netmask"
    description: "Management network"
    tags: ["Management"]
  - name: "Source_Protection_Network"
    value: "10.100.0.0/16"
    type: "ip-netmask"
    description: "Fourth Estate source protection network"
    tags: ["FourthEstate", "SourceProtection"]
  - name: "Journalist_Workspace"
    value: "10.200.0.0/16"
    type: "ip-netmask"
    description: "Fourth Estate journalist workspace"
    tags: ["FourthEstate", "Journalists"]

# FQDN address objects
panos_fqdn_objects:
  - name: "Update_Server"
    fqdn: "updates.paloaltonetworks.com"
    description: "Palo Alto Updates Server"
    tags: ["PaloAlto", "Updates"]
  - name: "WildFire_Cloud"
    fqdn: "wildfire.paloaltonetworks.com"
    description: "WildFire cloud analysis"
    tags: ["PaloAlto", "WildFire"]

# IP range objects
panos_ip_range_objects:
  - name: "DHCP_Pool"
    range: "10.1.100.1-10.1.100.254"
    description: "DHCP address pool"
    tags: ["DHCP"]

# IP wildcard objects
panos_ip_wildcard_objects: []

# Static address groups
panos_static_address_groups:
  - name: "RFC1918_Networks"
    members:
      - "Corporate_Network"
      - "DMZ_Network"
      - "Management_Network"
    description: "All RFC1918 private networks"
    tags: ["Internal"]
  - name: "Fourth_Estate_Networks"
    members:
      - "Source_Protection_Network"
      - "Journalist_Workspace"
    description: "All Fourth Estate networks"
    tags: ["FourthEstate"]
  - name: "Critical_Assets"
    members:
      - "Management_Network"
      - "Source_Protection_Network"
    description: "Critical infrastructure assets"
    tags: ["Critical"]

# Dynamic address groups (filter-based)
panos_dynamic_address_groups:
  - name: "Malicious_IPs"
    filter: "'ThreatIntel' and 'Malware'"
    description: "Dynamically updated malicious IP addresses"
    tags: ["Threat", "Dynamic"]
  - name: "High_Risk_Countries"
    filter: "'Region' and 'HighRisk'"
    description: "High-risk geographic regions"
    tags: ["GeoIP", "HighRisk"]

# TCP service objects
panos_tcp_service_objects:
  - name: "HTTPS"
    port: "443"
    description: "HTTPS web traffic"
    tags: ["Web"]
  - name: "HTTP_ALT"
    port: "8080"
    description: "Alternative HTTP port"
    tags: ["Web"]
  - name: "SSH"
    port: "22"
    description: "Secure Shell"
    tags: ["Management"]
  - name: "RDP"
    port: "3389"
    description: "Remote Desktop Protocol"
    tags: ["Management"]
  - name: "SMTP"
    port: "25"
    description: "Simple Mail Transfer Protocol"
    tags: ["Email"]
  - name: "SMTPS"
    port: "587"
    description: "SMTP with STARTTLS"
    tags: ["Email"]

# UDP service objects
panos_udp_service_objects:
  - name: "DNS"
    port: "53"
    description: "Domain Name System"
    tags: ["Infrastructure"]
  - name: "NTP"
    port: "123"
    description: "Network Time Protocol"
    tags: ["Infrastructure"]
  - name: "SNMP"
    port: "161"
    description: "Simple Network Management Protocol"
    tags: ["Monitoring"]
  - name: "Syslog"
    port: "514"
    description: "Syslog"
    tags: ["Logging"]

# Service groups
panos_service_groups:
  - name: "Web_Services"
    members:
      - "service-http"
      - "service-https"
      - "HTTP_ALT"
    tags: ["Web"]
  - name: "Email_Services"
    members:
      - "SMTP"
      - "SMTPS"
    tags: ["Email"]
  - name: "Management_Services"
    members:
      - "SSH"
      - "RDP"
    tags: ["Management"]

# Custom application objects
panos_custom_applications:
  - name: "Custom_CMS"
    category: "business-systems"
    subcategory: "general-business"
    technology: "client-server"
    risk: "2"
    ports:
      - "tcp/8443"
      - "tcp/9443"
    description: "Custom Content Management System"
    signature:
      name: "CMS_Signature"
      scope: "transaction"
      pattern: "/cms/api/"
      context: "http-req-uri-path"

# Application groups
panos_application_groups:
  - name: "Social_Media"
    members:
      - "facebook"
      - "twitter"
      - "linkedin"
      - "instagram"
  - name: "File_Sharing"
    members:
      - "dropbox"
      - "box"
      - "google-drive"
      - "onedrive"
  - name: "Streaming_Media"
    members:
      - "youtube"
      - "netflix"
      - "spotify"

# Application filters
panos_application_filters:
  - name: "High_Risk_Apps"
    risk_levels: ["4", "5"]
    evasive: true
    used_by_malware: true
    has_known_vulnerabilities: true
  - name: "Bandwidth_Intensive"
    excessive_bandwidth: true
    categories: ["media"]
  - name: "File_Transfer_Apps"
    transfers_files: true
  - name: "Tunneling_Apps"
    tunnels_other_apps: true
    evasive: true

# Tags for object categorization
panos_tags:
  - name: "Internal"
    color: "color2"  # Green
    comments: "Internal resources"
  - name: "DMZ"
    color: "color6"  # Orange
    comments: "DMZ resources"
  - name: "External"
    color: "color1"  # Red
    comments: "External/Internet resources"
  - name: "FourthEstate"
    color: "color3"  # Blue
    comments: "Fourth Estate specific resources"
  - name: "SourceProtection"
    color: "color11"  # Purple
    comments: "Source protection resources"
  - name: "Journalists"
    color: "color14"  # Cyan
    comments: "Journalist resources"
  - name: "Critical"
    color: "color1"  # Red
    comments: "Critical infrastructure"
  - name: "Threat"
    color: "color1"  # Red
    comments: "Threat intelligence"
  - name: "Web"
    color: "color3"  # Blue
    comments: "Web services"
  - name: "Email"
    color: "color12"  # Yellow
    comments: "Email services"
  - name: "Management"
    color: "color6"  # Orange
    comments: "Management services"

# External Dynamic Lists (IP)
panos_edl_ip_lists:
  - name: "Emerging_Threats_IPs"
    url: "https://rules.emergingthreats.net/blockrules/compromised-ips.txt"
    frequency: "hourly"
    description: "Emerging Threats compromised IP addresses"
  - name: "Tor_Exit_Nodes"
    url: "https://check.torproject.org/exit-addresses"
    frequency: "daily"
    at: "02"
    description: "Tor network exit nodes"
  - name: "Spamhaus_DROP"
    url: "https://www.spamhaus.org/drop/drop.txt"
    frequency: "daily"
    at: "03"
    description: "Spamhaus Don't Route Or Peer list"

# External Dynamic Lists (URL)
panos_edl_url_lists:
  - name: "Malware_URLs"
    url: "https://malware-urls.com/blocklist.txt"
    frequency: "hourly"
    description: "Known malware distribution URLs"
  - name: "Phishing_URLs"
    url: "https://phishing-urls.com/blocklist.txt"
    frequency: "hourly"
    description: "Known phishing URLs"

# External Dynamic Lists (Domain)
panos_edl_domain_lists:
  - name: "Malicious_Domains"
    url: "https://malicious-domains.com/blocklist.txt"
    frequency: "hourly"
    expand_domain: true
    description: "Known malicious domains"
  - name: "C2_Domains"
    url: "https://c2-tracker.com/blocklist.txt"
    frequency: "hourly"
    expand_domain: true
    description: "Command and Control domains"

# Custom URL categories
panos_custom_url_categories:
  - name: "Approved_News_Sites"
    type: "URL List"
    urls:
      - "reuters.com"
      - "apnews.com"
      - "bbc.com"
      - "nytimes.com"
    description: "Approved news and media sites"
  - name: "Blocked_Social_Media"
    type: "URL List"
    urls:
      - "facebook.com"
      - "twitter.com"
      - "instagram.com"
    description: "Blocked social media sites"
  - name: "Internal_Web_Apps"
    type: "URL List"
    urls:
      - "*.internal.local"
      - "*.corp.local"
    description: "Internal web applications"

# Schedule objects
panos_schedules:
  - name: "Business_Hours"
    type: "recurring"
    recurring:
      type: "weekly"
      days: ["monday", "tuesday", "wednesday", "thursday", "friday"]
      time_range: "08:00-18:00"
  - name: "Maintenance_Window"
    type: "recurring"
    recurring:
      type: "weekly"
      days: ["sunday"]
      time_range: "02:00-06:00"
  - name: "Off_Hours"
    type: "recurring"
    recurring:
      type: "weekly"
      days: ["monday", "tuesday", "wednesday", "thursday", "friday"]
      time_range: "18:00-08:00"

# Registered IPs (for region-based policies)
panos_registered_ips: []

# Security zones
panos_security_zones:
  - name: "trust"
    mode: "layer3"
    userid: true
    device_id: true
    log_setting: "Forward_to_SIEM"
  - name: "untrust"
    mode: "layer3"
    userid: false
    device_id: true
    log_setting: "Forward_to_SIEM"
  - name: "dmz"
    mode: "layer3"
    userid: false
    device_id: true
    log_setting: "Forward_to_SIEM"
  - name: "source_protection"
    mode: "layer3"
    userid: true
    device_id: true
    log_setting: "Forward_to_SIEM"
  - name: "journalist_workspace"
    mode: "layer3"
    userid: true
    device_id: true
    log_setting: "Forward_to_SIEM"

# Log forwarding profiles
panos_log_forwarding_profiles:
  - name: "Forward_to_SIEM"
    enhanced_logging: true
    match_list:
      - name: "Traffic_Logs"
        log_type: "traffic"
        filter: "All Logs"
        send_to_panorama: true
        syslog_profiles: ["SIEM_Primary"]
      - name: "Threat_Logs"
        log_type: "threat"
        filter: "All Logs"
        send_to_panorama: true
        syslog_profiles: ["SIEM_Primary"]
      - name: "URL_Logs"
        log_type: "url"
        filter: "All Logs"
        send_to_panorama: true
        syslog_profiles: ["SIEM_Primary"]
      - name: "WildFire_Logs"
        log_type: "wildfire"
        filter: "All Logs"
        send_to_panorama: true
        syslog_profiles: ["SIEM_Primary"]
