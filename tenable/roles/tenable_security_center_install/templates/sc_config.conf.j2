# Security Center Configuration File
# Generated by Ansible on {{ ansible_date_time.iso8601 }}

# Network Configuration
ServerName={{ tsc_hostname }}
HTTPSPort={{ tsc_https_port }}
HTTPPort={{ tsc_http_port }}

# SSL/TLS Configuration
SSLCertificateFile=/opt/sc/support/conf/ssl/server.crt
SSLCertificateKeyFile=/opt/sc/support/conf/ssl/server.key
SSLProtocol=TLSv1.2 TLSv1.3
SSLCipherSuite=ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384

# Database Configuration
DBType={{ tsc_db_type }}
DBHost={{ tsc_db_host }}
DBPort={{ tsc_db_port }}
DBName={{ tsc_db_name }}
DBUser={{ tsc_db_user }}
DBPassword={{ tsc_db_password }}

# Data Directory
DataDirectory={{ tsc_data_dir }}

# Logging Configuration
LogLevel={{ tsc_log_level }}
LogDirectory=/opt/sc/logs

# Plugin Feed
PluginFeedURL={{ tsc_plugin_feed_url }}
AutoUpdatePlugins={{ tsc_auto_plugin_update | lower }}

# Fourth Estate Specific Settings
{% if tsc_fourth_estate.enable_audit_logging %}
AuditLogging=enabled
AuditLogRetention={{ tsc_fourth_estate.data_retention_days }}
{% endif %}

{% if tsc_fourth_estate.compliance_mode %}
ComplianceMode=enabled
{% endif %}

{% if tsc_fourth_estate.fips_mode %}
FIPSMode=enabled
{% endif %}

# Session Configuration
SessionTimeout=3600
MaxConcurrentSessions=100

# API Configuration
APIEnabled=yes
APIRateLimit=1000

# Security Settings
PasswordComplexity=high
PasswordMinLength=15
PasswordExpiration=90
MaxLoginAttempts=5
LockoutDuration=1800
