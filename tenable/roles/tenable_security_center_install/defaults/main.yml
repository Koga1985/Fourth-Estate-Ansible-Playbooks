---
# tenable_security_center_install/defaults/main.yml
# Default variables for Tenable Security Center Installation

# Version and Package
tsc_version: "6.2.0"
tsc_package_ext: "{{ 'rpm' if ansible_os_family == 'RedHat' else 'deb' }}"
tsc_download_url: "https://downloads.tenable.com/SecurityCenter"
tsc_download_enabled: false
tsc_package_path: ""
tsc_checksum: ""
tsc_cleanup_package: true

# Installation Directories
tsc_install_dir: "/opt/sc"
tsc_data_dir: "/var/sc"
tsc_create_data_dir: true

# License Configuration
tsc_license_file: ""
tsc_license_content: ""

# Admin Account Configuration
tsc_admin_username: "admin"
tsc_admin_password: "{{ vault_tsc_admin_password }}"
tsc_admin_email: "security@agency.gov"
tsc_admin_firstname: "Security"
tsc_admin_lastname: "Administrator"

# Network Configuration
tsc_hostname: "{{ ansible_fqdn }}"
tsc_https_port: 443
tsc_http_port: 80

# SSL/TLS Configuration
tsc_ssl_cert: ""
tsc_ssl_key: ""
tsc_generate_self_signed: true
tsc_ssl_state: "DC"
tsc_ssl_city: "Washington"
tsc_ssl_org: "Fourth Estate Agency"
tsc_validate_certs: true

# Database Configuration
tsc_db_type: "postgresql"
tsc_db_name: "tenable_sc"
tsc_db_user: "tenable"
tsc_db_password: "{{ vault_tsc_db_password }}"
tsc_db_host: "localhost"
tsc_db_port: 5432

# PostgreSQL Configuration
postgresql_config_dir: "{{ '/var/lib/pgsql/data' if ansible_os_family == 'RedHat' else '/etc/postgresql/14/main' }}"
tsc_pg_shared_buffers: "256MB"
tsc_pg_effective_cache_size: "1GB"
tsc_pg_maintenance_work_mem: "128MB"

# MySQL Configuration
mysql_service_name: "{{ 'mysqld' if ansible_os_family == 'RedHat' else 'mysql' }}"
mysql_config_file: "{{ '/etc/my.cnf' if ansible_os_family == 'RedHat' else '/etc/mysql/mysql.conf.d/mysqld.cnf' }}"
tsc_mysql_root_password: "{{ vault_tsc_mysql_root_password }}"
tsc_mysql_buffer_pool_size: "512M"

# Plugin Feed Configuration
tsc_auto_plugin_update: true
tsc_plugin_update_hour: "2"
tsc_plugin_update_minute: "0"
tsc_plugin_feed_url: "https://plugins.nessus.org"

# Firewall Configuration
tsc_configure_firewall: true

# SELinux Configuration
tsc_configure_selinux: true

# System Requirements
tsc_min_memory_mb: 8192
tsc_min_disk_gb: 100

# Fourth Estate Specific Settings
tsc_fourth_estate:
  enable_audit_logging: true
  data_retention_days: 365
  compliance_mode: true
  fips_mode: false
  air_gapped: false

# Service Configuration
tsc_service_enabled: true
tsc_service_state: started

# Log Configuration
tsc_log_level: "info"
tsc_log_retention_days: 90
