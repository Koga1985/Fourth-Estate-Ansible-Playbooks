---
# tenable_scan_policies/defaults/main.yml

# Connection Settings
tsc_host: "{{ ansible_fqdn }}"
tsc_port: 443
tsc_username: "admin"
tsc_password: "{{ vault_tsc_password }}"
tsc_validate_certs: true

# Standard Scan Policies for Fourth Estate
tsc_scan_policies:
  - name: "Basic Network Scan"
    description: "Basic network discovery and vulnerability scan with safe checks"
    template: "basic_network_scan"
    template_id: "1"
    tags: "discovery,basic"

  - name: "Advanced Scan"
    description: "Advanced vulnerability scan with comprehensive plugin coverage"
    template: "advanced_scan"
    template_id: "2"
    tags: "advanced,comprehensive"

  - name: "Web Application Scan"
    description: "Specialized scan for web applications and services"
    template: "web_application_scan"
    template_id: "3"
    tags: "web,application"

  - name: "Credentialed Patch Audit"
    description: "Authenticated scan for patch compliance verification"
    template: "credentialed_patch_audit"
    template_id: "4"
    tags: "credentialed,patching"

  - name: "SCAP and OVAL Audits"
    description: "Security Content Automation Protocol compliance scanning"
    template: "scap_oval_audit"
    template_id: "5"
    tags: "scap,compliance"

  - name: "PCI Quarterly External Scan"
    description: "Payment Card Industry compliance scan for external systems"
    template: "pci_external_scan"
    template_id: "6"
    tags: "pci,compliance,external"

  - name: "Fourth Estate Baseline Scan"
    description: "Baseline security scan for Fourth Estate requirements"
    template: "fourth_estate_baseline"
    template_id: "7"
    tags: "fourth_estate,baseline"

# Custom Policies
tsc_custom_policies: []

# Default Scan Settings
tsc_scan_settings:
  safe_checks: true
  silent_dependencies: true
  log_scan_details: true
  stop_scan_on_disconnect: false
  consider_unscanned_as_lpr: false
  scan_network_printers: false
  scan_netware_hosts: false

  # Performance Settings
  max_checks_per_host: 5
  max_hosts_per_scan: 100
  network_receive_timeout: 5
  max_simult_tcp_sessions: 30
  max_simult_tcp_sessions_per_host: 10
  max_simult_tcp_sessions_per_scan: 50

  # Port Scanning
  port_range: "default"
  custom_port_range: ""
  tcp_scan_type: "SYN"
  udp_scan: true
  syn_scan: true
  syn_firewall_detection: "automatic"

  # Service Detection
  service_detection: true
  ssl_cipher_strength: true
  enumerate_all_ciphers: true

  # Fourth Estate Specific
  enable_fed_compliant_scans: true
  disable_dangerous_plugins: true
  enable_cve_correlation: true
