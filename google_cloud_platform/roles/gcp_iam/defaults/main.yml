---
# defaults file for gcp_iam
# Fourth Estate GCP IAM default configuration

# Project configuration
gcp_project_id: ""
gcp_organization_id: ""
gcp_auth_kind: "serviceaccount"
gcp_service_account_file: ""

# Service accounts to create
gcp_iam_service_accounts: []
  # - name: "news-publisher"
  #   display_name: "News Publisher Service Account"
  #   description: "Service account for news publishing system"
  #   create_key: true
  # - name: "content-manager"
  #   display_name: "Content Management Service Account"
  #   description: "Service account for CMS operations"
  #   create_key: false

# Custom IAM roles
gcp_iam_custom_roles: []
  # - role_id: "fourthEstateEditor"
  #   title: "Fourth Estate Editor"
  #   description: "Custom role for editorial staff"
  #   permissions:
  #     - storage.buckets.get
  #     - storage.objects.create
  #     - storage.objects.delete
  #     - storage.objects.get
  #     - storage.objects.list
  #   stage: "GA"
  #   update_if_exists: true

# IAM policy bindings at project level
gcp_iam_policy_bindings: []
  # - member: "serviceAccount:news-publisher@project-id.iam.gserviceaccount.com"
  #   role: "roles/storage.objectAdmin"
  # - member: "group:editors@fourtestatenews.com"
  #   role: "projects/project-id/roles/fourthEstateEditor"

# Conditional IAM bindings (attribute-based and time-based access)
gcp_iam_conditional_bindings: []
  # - name: "business_hours_access"
  #   member: "group:editors@fourtestatenews.com"
  #   role: "roles/compute.instanceAdmin.v1"
  #   condition:
  #     title: "Business Hours Only"
  #     description: "Access only during business hours"
  #     expression: 'request.time.getHours("America/New_York") >= 9 && request.time.getHours("America/New_York") <= 17'

# Workload Identity for GKE
gcp_iam_enable_workload_identity: false
gcp_iam_workload_identity_bindings: []
  # - gcp_service_account: "news-publisher"
  #   k8s_namespace: "production"
  #   k8s_service_account: "publisher-sa"

# Service account impersonation
gcp_iam_impersonation_bindings: []
  # - service_account: "news-publisher"
  #   member: "user:admin@fourtestatenews.com"

# Organization-level IAM policies
gcp_iam_org_policy_bindings: []
  # - member: "group:security-team@fourtestatenews.com"
  #   role: "roles/securitycenter.admin"

# Folder-level IAM policies
gcp_iam_folder_policy_bindings: []
  # - folder_id: "123456789"
  #   member: "group:platform-team@fourtestatenews.com"
  #   role: "roles/resourcemanager.folderAdmin"

# Service account key management
gcp_iam_keys_output_dir: "/tmp/gcp_sa_keys"
gcp_iam_enable_key_rotation: true
gcp_iam_key_rotation_days: 90

# Audit and compliance
gcp_iam_enable_audit: true
gcp_iam_enable_audit_logging: true
gcp_iam_artifacts_dir: "/tmp/gcp_iam_artifacts"

# Fourth Estate compliance settings
gcp_iam_fedramp_mode: true
gcp_iam_cjis_mode: false
gcp_iam_source_protection_mode: true

# Predefined roles for Fourth Estate agencies
gcp_iam_fourth_estate_roles:
  editorial_staff:
    - "roles/storage.objectViewer"
    - "roles/pubsub.viewer"
  publishing_system:
    - "roles/storage.objectAdmin"
    - "roles/pubsub.publisher"
    - "roles/cdn.admin"
  security_team:
    - "roles/securitycenter.admin"
    - "roles/logging.viewer"
    - "roles/monitoring.viewer"
  platform_admins:
    - "roles/compute.admin"
    - "roles/container.admin"
    - "roles/iam.securityAdmin"

# IAM audit log configuration
gcp_iam_audit_log_config:
  - service: "allServices"
    audit_log_configs:
      - log_type: "ADMIN_READ"
      - log_type: "DATA_READ"
      - log_type: "DATA_WRITE"

# Domain restriction for IAM
gcp_iam_domain_restriction: ""
# gcp_iam_domain_restriction: "fourtestatenews.com"

# Service account naming convention
gcp_iam_sa_prefix: "fe"  # Fourth Estate prefix
gcp_iam_sa_environment: "prod"

# Maximum number of service account keys per account
gcp_iam_max_keys_per_sa: 2

# Enable detailed IAM policy analysis
gcp_iam_enable_policy_analyzer: true

# Retention period for IAM audit logs (days)
gcp_iam_audit_retention_days: 365
