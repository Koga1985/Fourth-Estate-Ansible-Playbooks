{
  "key_rotation_policy": {
    "rotation_period_days": {{ gcp_iam_key_rotation_days }},
    "max_keys_per_service_account": {{ gcp_iam_max_keys_per_sa }},
    "automated_rotation": {{ gcp_iam_enable_key_rotation | lower }},
    "notification_channels": [
{% if gcp_iam_security_contact_email is defined %}
      "{{ gcp_iam_security_contact_email }}"
{% endif %}
    ],
    "enforcement": {
      "fedramp_mode": {{ gcp_iam_fedramp_mode | lower }},
      "cjis_mode": {{ gcp_iam_cjis_mode | lower }}
    }
  },
  "compliance_requirements": {
    "fourth_estate": {
      "source_protection": {{ gcp_iam_source_protection_mode | lower }},
      "audit_retention_days": {{ gcp_iam_audit_retention_days }},
      "domain_restriction": "{{ gcp_iam_domain_restriction }}"
    }
  }
}
