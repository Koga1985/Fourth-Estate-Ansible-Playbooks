---
# HashiCorp Vault Installation Handlers
# Fourth Estate Production Configuration

- name: systemd daemon reload
  ansible.builtin.systemd:
    daemon_reload: true

- name: restart vault
  ansible.builtin.systemd:
    name: vault
    state: restarted
  when:
    - vault_service_enabled | bool
    - ansible_service_mgr == "systemd"

- name: reload vault
  ansible.builtin.systemd:
    name: vault
    state: reloaded
  when:
    - vault_service_enabled | bool
    - ansible_service_mgr == "systemd"

- name: restart rsyslog
  ansible.builtin.systemd:
    name: rsyslog
    state: restarted

- name: restorecon vault directories
  ansible.builtin.command: restorecon -R {{ item }}
  loop:
    - "{{ vault_config_path }}"
    - "{{ vault_data_path }}"
    - "{{ vault_log_path }}"
  changed_when: false
